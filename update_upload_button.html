<!DOCTYPE html>
<html>
<head>
  <title>修正用スクリプト</title>
</head>
<body>

<script>
// ボタンクリック時に直接モーダルを表示
document.addEventListener('DOMContentLoaded', function() {
  const button = document.getElementById('tourist-upload-id');
  
  if (button) {
    // 既存のイベントをすべて削除
    const newButton = button.cloneNode(true);
    if (button.parentNode) {
      button.parentNode.replaceChild(newButton, button);
    }
    
    // 新しいボタンにクリックイベントを追加
    newButton.addEventListener('click', function(e) {
      e.preventDefault();
      console.log('ボタンクリック: 直接モーダル表示方式');
      
      // 観光客登録モーダルを閉じる
      const registerModal = document.getElementById('touristRegisterModal');
      if (registerModal) {
        const bsModal = bootstrap.Modal.getInstance(registerModal);
        if (bsModal) {
          bsModal.hide();
        }
      }
      
      // 新しいモーダルを表示（直接DOM操作）
      setTimeout(function() {
        // まず古いバックドロップをクリア
        document.querySelectorAll('.modal-backdrop').forEach(function(el) {
          document.body.removeChild(el);
        });
        
        // 新しいバックドロップを作成
        const backdrop = document.createElement('div');
        backdrop.className = 'modal-backdrop fade show';
        document.body.appendChild(backdrop);
        
        // 本人確認モーダルを表示
        const idModal = document.getElementById('idDocumentModal');
        if (idModal) {
          // ユーザータイプを設定
          const userTypeField = idModal.querySelector('input[name="user-type"]');
          if (userTypeField) {
            userTypeField.value = 'tourist';
          } else {
            const newField = document.createElement('input');
            newField.type = 'hidden';
            newField.name = 'user-type';
            newField.value = 'tourist';
            idModal.querySelector('form').appendChild(newField);
          }
          
          // モーダルを表示
          idModal.classList.add('show');
          idModal.style.display = 'block';
          idModal.setAttribute('aria-modal', 'true');
          idModal.removeAttribute('aria-hidden');
          
          document.body.classList.add('modal-open');
          
          // イベントを発火
          const event = new Event('shown.bs.modal');
          idModal.dispatchEvent(event);
        }
      }, 500);
    });
  }
});
</script>

</body>
</html>
