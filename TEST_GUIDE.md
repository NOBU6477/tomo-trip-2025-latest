# TomoTrip 実際の使用手順ガイド

## 📱 あなたのアプリURL
```
https://31176088-3ca0-49de-9098-7b5f0f0a1c9a-00-1jhrgwtjgmb39.kirk.replit.dev
```

---

## 🎯 1. 新規ガイド登録の手順

### ステップ1：登録ページにアクセス
```
https://31176088-3ca0-49de-9098-7b5f0f0a1c9a-00-1jhrgwtjgmb39.kirk.replit.dev/guide-registration-perfect.html
```

### ステップ2：基本情報を入力

1. **ガイド名**: 例）山田太郎
2. **メールアドレス**: 例）yamada@example.com
   - メールアドレスを入力後、フィールドの外をクリック（blur）すると自動で重複チェックが実行されます
   - ✅ 緑のチェックマーク = 使用可能
   - ❌ 赤のエラー = 既に登録済み

3. **性別**: 男性/女性/その他から選択
4. **年齢**: 数値を入力
5. **活動地域**: ドロップダウンから都道府県を選択（124オプション）

### ステップ3：電話認証

1. **電話番号**: 090-1234-5678 形式で入力
2. **「認証コード送信」ボタンをクリック**
   - 開発モードでは、画面に認証コードが表示されます（例：`開発モード: 認証コードは 123456 です`）
3. **認証コード**: 表示されたコードを入力
4. **「認証確認」ボタンをクリック**
   - 成功すると「認証完了」と表示されます

### ステップ4：身分証明書アップロード

1. **証明書タイプ**: 運転免許証/パスポート/保険証から選択
2. **写真をアップロード**:
   - 運転免許証・保険証：表面と裏面の2枚
   - パスポート：1枚

### ステップ5：ガイド詳細情報

1. **対応言語**: 複数選択可能（日本語、英語、中国語など）
2. **自己紹介**: 案内スタイルや得意分野を入力
3. **専門分野**: グルメ、歴史、写真スポットなど
4. **料金**: 1セッションあたりの料金（円）
5. **利用可能時間**: 平日のみ/週末のみ/両方

### ステップ6：登録完了

- **「ガイド登録」ボタンをクリック**
- 登録完了モーダルが表示され、**ガイドID**が発行されます
- **このガイドIDを必ずメモしてください！**（例：`577f0c89-fa4f-44e8-8f7f-a4ddb9431767`）

---

## 📊 2. ガイドダッシュボードの確認

### 正しいアクセス方法

登録完了後に発行された**ガイドID**を使用してアクセスします：

```
https://31176088-3ca0-49de-9098-7b5f0f0a1c9a-00-1jhrgwtjgmb39.kirk.replit.dev/guide-dashboard.html?id=ガイドID
```

**例（実際の登録ガイド）：**
```
https://31176088-3ca0-49de-9098-7b5f0f0a1c9a-00-1jhrgwtjgmb39.kirk.replit.dev/guide-dashboard.html?id=577f0c89-fa4f-44e8-8f7f-a4ddb9431767
```

### 表示される情報

1. **今月の配当カード**
   - 合計金額：¥25,000（例）
   - 内訳：各協賛店への送客による報酬

2. **ランクカード**
   - 現在のランク：Bronze（初期）
   - 次のランクまでのポイント：60pt（Silverまで）
   - 進捗バー

3. **ランク早見表**
   | ランク | 必要ポイント | 配当ボーナス |
   |--------|-------------|-------------|
   | Bronze | 0 pt | +0% |
   | Silver | 60 pt | +5% |
   | Gold | 120 pt | +10% |
   | Platinum | 200 pt | +15% |

### プロフィール編集

- **「プロフィール編集」ボタンをクリック**
- ガイドIDが自動的に引き継がれ、編集ページに遷移します
- URLは自動的に `/guide-edit.html?id=ガイドID` となります

---

## 🏪 3. 協賛店登録の手順

### ステップ1：登録ページにアクセス
```
https://31176088-3ca0-49de-9098-7b5f0f0a1c9a-00-1jhrgwtjgmb39.kirk.replit.dev/sponsor-login.html
```

### ステップ2：店舗情報を入力

1. **店舗名**: 例）沖縄そば ま～さん
2. **メールアドレス**: 例）maasan@example.com
3. **電話番号**: 例）098-123-4567
4. **住所**: 店舗の住所
5. **カテゴリー**: レストラン/ショップ/アクティビティなど
6. **店舗紹介**: お店の特徴やアピールポイント

### ステップ3：登録完了

- **店舗ID**が発行されます
- **このIDを必ずメモしてください！**

---

## 📈 4. 協賛店ダッシュボードの確認

### 正しいアクセス方法

```
https://31176088-3ca0-49de-9098-7b5f0f0a1c9a-00-1jhrgwtjgmb39.kirk.replit.dev/store-dashboard.html?id=店舗ID
```

**例（実際の登録店舗）：**
```
https://31176088-3ca0-49de-9098-7b5f0f0a1c9a-00-1jhrgwtjgmb39.kirk.replit.dev/store-dashboard.html?id=b73af3d7-a4ea-4c7f-84f1-3e17534c79b0
```

### 表示される情報

1. **効果測定カード**
   - 送客数：15人
   - 予約数：12件
   - 来店率：80%
   - 動画再生数：120回

2. **TOP貢献ガイド**
   - 🥇 1位：田中太郎 - 送客8人、来店率90%
   - 🥈 2位：佐藤花子 - 送客5人、来店率75%
   - 🥉 3位：鈴木一郎 - 送客2人、来店率50%

---

## 🧪 5. すぐ試せるテスト用URL

### ガイドダッシュボード（既存データ）

**テスト太郎のダッシュボード**
```
https://31176088-3ca0-49de-9098-7b5f0f0a1c9a-00-1jhrgwtjgmb39.kirk.replit.dev/guide-dashboard.html?id=577f0c89-fa4f-44e8-8f7f-a4ddb9431767
```

**林修のダッシュボード**
```
https://31176088-3ca0-49de-9098-7b5f0f0a1c9a-00-1jhrgwtjgmb39.kirk.replit.dev/guide-dashboard.html?id=fa12dc14-1899-4bd5-bbd3-8ce0a2c359e9
```

**仲宗根りんのダッシュボード**
```
https://31176088-3ca0-49de-9098-7b5f0f0a1c9a-00-1jhrgwtjgmb39.kirk.replit.dev/guide-dashboard.html?id=cc51ea1f-f285-440a-9159-fce867090e3b
```

### 協賛店ダッシュボード（既存データ）

**沖縄そば ま～さん**
```
https://31176088-3ca0-49de-9098-7b5f0f0a1c9a-00-1jhrgwtjgmb39.kirk.replit.dev/store-dashboard.html?id=b73af3d7-a4ea-4c7f-84f1-3e17534c79b0
```

**イタリアン ぼ～の**
```
https://31176088-3ca0-49de-9098-7b5f0f0a1c9a-00-1jhrgwtjgmb39.kirk.replit.dev/store-dashboard.html?id=b08a8b4f-cef2-4714-9b81-1bb2e9b212ef
```

**アメリカンホットドッグ**
```
https://31176088-3ca0-49de-9098-7b5f0f0a1c9a-00-1jhrgwtjgmb39.kirk.replit.dev/store-dashboard.html?id=bc57a933-1901-4bd2-8bd4-8b61937c2d47
```

---

## 🔧 6. 管理者API（開発者向け）

### ランク一覧取得
```
https://31176088-3ca0-49de-9098-7b5f0f0a1c9a-00-1jhrgwtjgmb39.kirk.replit.dev/api/admin/ranks
```

**期待される結果：**
```json
[
  {"name":"Bronze","minScore":0,"bonusRate":0,"maxStores":20},
  {"name":"Silver","minScore":60,"bonusRate":0.05,"maxStores":50},
  {"name":"Gold","minScore":120,"bonusRate":0.1,"maxStores":100},
  {"name":"Platinum","minScore":200,"bonusRate":0.15,"maxStores":100}
]
```

### Feature Flags取得
```
https://31176088-3ca0-49de-9098-7b5f0f0a1c9a-00-1jhrgwtjgmb39.kirk.replit.dev/api/admin/flags
```

**期待される結果：**
```json
{
  "ENABLE_PAYOUTS": true,
  "ENABLE_GUIDE_RANKING": true,
  "SHOW_GUIDE_REAL_NAME_TO_STORE": false
}
```

### ガイド詳細情報取得
```
https://31176088-3ca0-49de-9098-7b5f0f0a1c9a-00-1jhrgwtjgmb39.kirk.replit.dev/api/guides/577f0c89-fa4f-44e8-8f7f-a4ddb9431767/dashboard
```

### 協賛店詳細情報取得
```
https://31176088-3ca0-49de-9098-7b5f0f0a1c9a-00-1jhrgwtjgmb39.kirk.replit.dev/api/stores/b73af3d7-a4ea-4c7f-84f1-3e17534c79b0/dashboard
```

---

## ❌ よくあるエラーと解決方法

### エラー1：「GUIDE_ID が未設定です」

**原因**: URLに `?id=ガイドID` が含まれていない

**解決方法**: 
```
❌ https://.../guide-dashboard.html
✅ https://.../guide-dashboard.html?id=577f0c89-fa4f-44e8-8f7f-a4ddb9431767
```

### エラー2：プロフィール編集でトップページに戻る

**原因**: 以前のバグ（修正済み）

**解決方法**: 
- ブラウザをリロード（Ctrl+F5 または Cmd+Shift+R）
- プロフィール編集ボタンをクリック
- 自動的に `/guide-edit.html?id=ガイドID` に遷移します

### エラー3：活動地域が選択できない

**原因**: JavaScriptの構文エラー（修正済み）

**解決方法**: 
- ブラウザをリロード
- 都道府県ドロップダウンが正常に表示されます（124オプション）

---

## 📋 テストチェックリスト

### ガイド登録
- [ ] ガイド登録ページにアクセスできる
- [ ] 基本情報（名前、メール、性別、年齢）が入力できる
- [ ] メールアドレスの重複チェックが動作する
- [ ] 活動地域のドロップダウンが表示される（124オプション）
- [ ] 電話認証コードが送信される
- [ ] 認証コードが確認できる
- [ ] 身分証明書がアップロードできる
- [ ] ガイド詳細情報が入力できる
- [ ] 登録完了でガイドIDが発行される

### ガイドダッシュボード
- [ ] URLに `?id=ガイドID` を付けてアクセスできる
- [ ] 今月の配当カードが表示される
- [ ] ランクカードが表示される（Bronze、次のランクまでのポイント）
- [ ] ランク早見表が表示される（4段階）
- [ ] プロフィール編集ボタンでガイドIDが引き継がれる

### 協賛店登録
- [ ] 協賛店登録ページにアクセスできる
- [ ] 店舗情報が入力できる
- [ ] 登録完了で店舗IDが発行される

### 協賛店ダッシュボード
- [ ] URLに `?id=店舗ID` を付けてアクセスできる
- [ ] 効果測定カードが表示される
- [ ] TOP貢献ガイドが表示される

### 管理者API
- [ ] `/api/admin/ranks` でランク一覧が取得できる
- [ ] `/api/admin/flags` でFeature Flagsが取得できる

---

## 🎉 完了！

すべてのテストが完了したら、本番環境へのデプロイ準備が整っています！
