<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å”è³›åº—ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ - TomoTrip</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            font-family: 'Segoe UI', Tango, Geneva, Verdana, sans-serif;
        }
        
        .preview-header {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255,255,255,0.2);
            padding: 1rem 0;
        }
        
        .preview-card {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
            border: 1px solid rgba(255, 255, 255, 0.18);
            overflow: hidden;
        }
        
        .store-image {
            width: 100%;
            height: 300px;
            object-fit: cover;
            border-radius: 15px;
        }
        
        .info-section {
            background: rgba(248, 249, 250, 0.8);
            border-radius: 10px;
            padding: 1rem;
            margin: 1rem 0;
        }
        
        .contact-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            transition: all 0.3s ease;
        }
        
        .contact-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
            color: white;
        }
        
        .image-placeholder {
            background: #f8f9fa;
            border: 2px dashed #dee2e6;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 200px;
        }
    </style>
</head>
<body>
    <div class="preview-header">
        <div class="container">
            <div class="d-flex justify-content-between align-items-center">
                <h2><i class="bi bi-eye"></i> å”è³›åº—ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</h2>
                <div>
                    <button class="btn btn-outline-secondary me-2" onclick="goBackToEdit()">
                        <i class="bi bi-arrow-left"></i> æˆ»ã‚‹
                    </button>
                    <button class="btn btn-outline-primary" onclick="toggleListView()">
                        <i class="bi bi-list"></i> ä¸€è¦§è¡¨ç¤º
                    </button>
                </div>
            </div>
            <p class="mb-0 text-muted">ãŠå®¢æ§˜ãŒè¦‹ã‚‹åº—èˆ—æƒ…å ±ã‚’ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã§ãã¾ã™</p>
        </div>
    </div>

    <div class="container my-4">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <div class="preview-card p-4">
                    <div class="row">
                        <!-- Store Image -->
                        <div class="col-md-6 mb-3">
                            <img id="previewImage" class="store-image" style="display: none;" alt="åº—èˆ—ç”»åƒ">
                            <div id="imagePlaceholder" class="image-placeholder">
                                <i class="bi bi-image" style="font-size: 3rem; color: #ccc;"></i>
                                <p class="mt-2 text-muted">ç”»åƒæœªè¨­å®š</p>
                            </div>
                        </div>
                        
                        <!-- Store Info -->
                        <div class="col-md-6">
                            <h3 id="previewStoreName" class="mb-3 text-primary">åº—èˆ—å</h3>
                            <p><i class="bi bi-tag"></i> <span id="previewCategory">ã‚«ãƒ†ã‚´ãƒª</span></p>
                            <p><i class="bi bi-geo-alt"></i> <span id="previewAddress">ä½æ‰€</span></p>
                            <p><i class="bi bi-telephone"></i> <span id="previewPhone">é›»è©±ç•ªå·</span></p>
                            <p><i class="bi bi-envelope"></i> <span id="previewEmail">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</span></p>
                            <div id="previewWebsite"></div>
                        </div>
                    </div>

                    <!-- Business Hours -->
                    <div class="info-section" id="businessHoursSection">
                        <h5><i class="bi bi-clock"></i> å–¶æ¥­æ™‚é–“</h5>
                        <p id="previewBusinessHours">å–¶æ¥­æ™‚é–“æœªè¨­å®š</p>
                        <p id="previewHolidays">å®šä¼‘æ—¥æœªè¨­å®š</p>
                    </div>

                    <!-- Description -->
                    <div class="info-section" id="descriptionSection">
                        <h5><i class="bi bi-card-text"></i> åº—èˆ—ç´¹ä»‹</h5>
                        <p id="previewDescription">åº—èˆ—èª¬æ˜æœªè¨­å®š</p>
                    </div>

                    <!-- Languages -->
                    <div class="info-section" id="languagesSection">
                        <h5><i class="bi bi-translate"></i> å¯¾å¿œè¨€èª</h5>
                        <div id="previewLanguages">å¯¾å¿œè¨€èªæœªè¨­å®š</div>
                    </div>

                    <!-- TomoTrip Benefits -->
                    <div class="info-section" id="benefitsSection">
                        <h5><i class="bi bi-gift"></i> TomoTripç‰¹å…¸</h5>
                        <div id="previewBenefits">ç‰¹å…¸æœªè¨­å®š</div>
                    </div>

                    <!-- Contact Actions -->
                    <div class="text-center mt-4">
                        <button class="contact-btn me-3">
                            <i class="bi bi-telephone"></i> é›»è©±ã§å•ã„åˆã‚ã›
                        </button>
                        <button class="contact-btn">
                            <i class="bi bi-envelope"></i> ãƒ¡ãƒ¼ãƒ«ã§å•ã„åˆã‚ã›
                        </button>
                    </div>
                </div>

                <!-- Edit Actions -->
                <div class="text-center mt-4">
                    <button class="btn btn-primary btn-lg me-3" onclick="goBackToEdit()">
                        <i class="bi bi-pencil"></i> ç·¨é›†ã«æˆ»ã‚‹
                    </button>
                    <button class="btn btn-success btn-lg" onclick="publishToList()">
                        <i class="bi bi-check-circle"></i> å…¬é–‹ã™ã‚‹
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰åº—èˆ—IDã‚’å–å¾—
        const urlParams = new URLSearchParams(window.location.search);
        const sponsorId = urlParams.get('id');
        
        console.log('ğŸ”— Preview page initialized');
        console.log('ğŸ“ Current URL:', window.location.href);
        console.log('ğŸ†” Sponsor ID from URL:', sponsorId);

        // åº—èˆ—ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚“ã§ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤ºï¼ˆå¼·åŒ–ç‰ˆï¼‰
        function loadPreview() {
            console.log('ğŸ” Loading preview for ID:', sponsorId);
            
            if (!sponsorId) {
                showError('åº—èˆ—IDãŒæŒ‡å®šã•ã‚Œã¦ã„ã¾ã›ã‚“');
                return;
            }

            // ãƒ‡ãƒãƒƒã‚°ï¼šå…¨ã¦ã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚­ãƒ¼ã¨å†…å®¹ã‚’å‡ºåŠ›
            console.log('ğŸ“Š ALL LOCALSTORAGE DEBUGGING:');
            const allKeys = Object.keys(localStorage);
            allKeys.forEach(key => {
                const value = localStorage.getItem(key);
                console.log(`ğŸ”‘ Key: ${key} | Length: ${value ? value.length : 0}`);
                if (key.includes('sponsor') || key.includes('test')) {
                    try {
                        const parsed = JSON.parse(value);
                        if (Array.isArray(parsed)) {
                            console.log(`  ğŸ“‹ Array with ${parsed.length} items:`, parsed.map(item => item?.id || 'no-id'));
                        } else {
                            console.log(`  ğŸ“„ Object ID: ${parsed?.id || 'no-id'}`);
                        }
                    } catch (e) {
                        console.log(`  âŒ Not JSON: ${value?.substring(0, 50)}...`);
                    }
                }
            });

            // ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ï¼ˆè¤‡æ•°ã®å ´æ‰€ã‹ã‚‰è©¦è¡Œï¼‰
            let sponsor = null;
            
            // 1. ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”¨ãƒ‡ãƒ¼ã‚¿ã‚’ç¢ºèª
            console.log('ğŸ” Step 1: Checking preview data...');
            const previewKey = `preview_${sponsorId}`;
            console.log(`  Looking for key: ${previewKey}`);
            const previewData = localStorage.getItem(previewKey);
            if (previewData) {
                try {
                    sponsor = JSON.parse(previewData);
                    console.log('âœ… Step 1 SUCCESS: Found preview data:', sponsor);
                } catch (e) {
                    console.error('âŒ Step 1 FAILED: Parse error:', e);
                }
            } else {
                console.log('âŒ Step 1 FAILED: No preview data found');
            }
            
            // 2. ç›´æ¥IDã‚­ãƒ¼ã§ã®å–å¾—
            if (!sponsor) {
                console.log('ğŸ” Step 2: Checking direct ID...');
                console.log(`  Looking for key: ${sponsorId}`);
                const directData = localStorage.getItem(sponsorId);
                if (directData) {
                    try {
                        sponsor = JSON.parse(directData);
                        console.log('âœ… Step 2 SUCCESS: Found direct ID data:', sponsor);
                    } catch (e) {
                        console.error('âŒ Step 2 FAILED: Parse error:', e);
                    }
                } else {
                    console.log('âŒ Step 2 FAILED: No direct data found');
                }
            }
            
            // 3. registeredSponsorsã‹ã‚‰å–å¾—
            if (!sponsor) {
                const registeredSponsors = JSON.parse(localStorage.getItem('registeredSponsors') || '[]');
                sponsor = registeredSponsors.find(s => s.id === sponsorId);
                if (sponsor) {
                    console.log('âœ… Found in registered sponsors:', sponsor);
                }
            }
            
            // 3.5. å„ç¨®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰ã‚‚æ¤œç´¢
            if (!sponsor) {
                const sessionKeys = ['sponsorSession', 'sponsorAccounts', 'sponsorData', 'sponsor_1'];
                for (const key of sessionKeys) {
                    try {
                        const sessionData = localStorage.getItem(key);
                        if (sessionData) {
                            const parsed = JSON.parse(sessionData);
                            if (Array.isArray(parsed)) {
                                sponsor = parsed.find(s => s && s.id === sponsorId);
                            } else if (parsed && parsed.id === sponsorId) {
                                sponsor = parsed;
                            }
                            if (sponsor) {
                                console.log(`âœ… Found in session storage ${key}:`, sponsor);
                                break;
                            }
                        }
                    } catch (e) {
                        console.error(`Failed to parse ${key}:`, e);
                    }
                }
            }
            
            // 4. å€‹åˆ¥ä¿å­˜ãƒ‡ãƒ¼ã‚¿ã‚’ç¢ºèª
            if (!sponsor) {
                const storeKey = `store_${sponsorId}`;
                const storeData = localStorage.getItem(storeKey);
                if (storeData) {
                    try {
                        sponsor = JSON.parse(storeData);
                        console.log('âœ… Found in store data:', sponsor);
                    } catch (e) {
                        console.error('Failed to parse store data:', e);
                    }
                }
            }
            
            // 5. æœ€å¾Œã®æ‰‹æ®µï¼šå…¨ã¦ã®ã‚­ãƒ¼ã‚’ã‚¹ã‚­ãƒ£ãƒ³
            if (!sponsor) {
                console.log('ğŸ” Scanning all localStorage keys...');
                const allKeys = Object.keys(localStorage);
                console.log('All available keys:', allKeys);
                
                // ã¾ãšéƒ¨åˆ†ä¸€è‡´ã§æ¤œç´¢
                for (const key of allKeys) {
                    if (key.includes(sponsorId) || sponsorId.includes(key) || 
                        key.includes('sponsor') || key.includes('test')) {
                        try {
                            const data = JSON.parse(localStorage.getItem(key));
                            if (data) {
                                // å˜ä¸€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å ´åˆ
                                if (data.id === sponsorId) {
                                    sponsor = data;
                                    console.log('âœ… Found via key scan (direct):', key, sponsor);
                                    break;
                                }
                                // é…åˆ—ã®å ´åˆ
                                if (Array.isArray(data)) {
                                    const found = data.find(item => item && item.id === sponsorId);
                                    if (found) {
                                        sponsor = found;
                                        console.log('âœ… Found via key scan (array):', key, sponsor);
                                        break;
                                    }
                                }
                            }
                        } catch (e) {
                            console.error('Failed to parse scanned data:', key, e);
                        }
                    }
                }
                
                // ã•ã‚‰ã«è¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã€å…¨ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚’ç¢ºèª
                if (!sponsor) {
                    for (const key of allKeys) {
                        try {
                            const data = localStorage.getItem(key);
                            if (data && data.includes(sponsorId)) {
                                const parsedData = JSON.parse(data);
                                if (parsedData.id === sponsorId || 
                                    (Array.isArray(parsedData) && parsedData.find(item => item.id === sponsorId))) {
                                    sponsor = Array.isArray(parsedData) ? 
                                        parsedData.find(item => item.id === sponsorId) : parsedData;
                                    console.log('âœ… Found via deep scan:', key, sponsor);
                                    break;
                                }
                            }
                        } catch (e) {
                            // JSONä»¥å¤–ã®ãƒ‡ãƒ¼ã‚¿ã¯ç„¡è¦–
                        }
                    }
                }
            }
            
            if (!sponsor) {
                console.error('âŒ No data found for ID:', sponsorId);
                
                // ãƒ‡ãƒãƒƒã‚°æƒ…å ±ã‚’è©³ç´°ã«è¡¨ç¤º
                console.log('Debug info for missing data:');
                console.log('- Searched ID:', sponsorId);
                console.log('- Available localStorage keys:', Object.keys(localStorage));
                console.log('- registeredSponsors content:', localStorage.getItem('registeredSponsors'));
                
                // ç·Šæ€¥å¯¾ç­–ï¼šé¡ä¼¼IDã§ã®æ¤œç´¢
                const allKeys = Object.keys(localStorage);
                const possibleKeys = allKeys.filter(key => 
                    key.includes('sponsor') || 
                    key.includes('kyoto') || 
                    key.includes('test') ||
                    key.includes(sponsorId.split('_').pop())
                );
                
                if (possibleKeys.length > 0) {
                    console.log('Possible matching keys found:', possibleKeys);
                    showError(`åº—èˆ—ID: ${sponsorId} ã®ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚\n\nåˆ©ç”¨å¯èƒ½ãªãƒ‡ãƒ¼ã‚¿: ${possibleKeys.join(', ')}\n\nãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã«æˆ»ã£ã¦ãƒ‡ãƒ¼ã‚¿ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚`);
                } else {
                    showError(`åº—èˆ—ID: ${sponsorId} ã®ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚\n\nãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã§ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆã—ã¦ã‹ã‚‰ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã—ã¦ãã ã•ã„ã€‚`);
                }
                return;
            }

            console.log('Preview data loaded successfully:', sponsor);
            displayPreview(sponsor);
        }

        function displayPreview(sponsor) {
            console.log('ğŸ¯ Displaying preview for sponsor:', sponsor);
            
            // æ¥­ç¨®åãƒãƒƒãƒ”ãƒ³ã‚°
            const categoryNames = {
                'restaurant': 'ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ãƒ»é£²é£Ÿåº—',
                'hotel': 'ãƒ›ãƒ†ãƒ«ãƒ»å®¿æ³Šæ–½è¨­',
                'shopping': 'ã‚·ãƒ§ãƒƒãƒ”ãƒ³ã‚°ãƒ»å°å£²',
                'entertainment': 'ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ†ã‚¤ãƒ¡ãƒ³ãƒˆ',
                'transport': 'äº¤é€šãƒ»ãƒ¬ãƒ³ã‚¿ãƒ«',
                'service': 'ã‚µãƒ¼ãƒ“ã‚¹æ¥­',
                'other': 'ãã®ä»–'
            };

            // åŸºæœ¬æƒ…å ±è¡¨ç¤º
            const storeName = sponsor.storeName || 'åº—èˆ—åæœªè¨­å®š';
            const category = categoryNames[sponsor.category] || sponsor.category || 'æœªåˆ†é¡';
            const address = sponsor.address || 'ä½æ‰€æœªè¨­å®š';
            const phone = sponsor.phone || 'é›»è©±ç•ªå·æœªè¨­å®š';
            const email = sponsor.email || 'ãƒ¡ãƒ¼ãƒ«æœªè¨­å®š';
            
            // è¦ç´ ã«å€¤ã‚’è¨­å®š
            document.getElementById('previewStoreName').textContent = storeName;
            document.getElementById('previewCategory').textContent = category;
            document.getElementById('previewAddress').textContent = address;
            document.getElementById('previewPhone').textContent = phone;
            document.getElementById('previewEmail').textContent = email;

            // ç”»åƒè¡¨ç¤ºï¼ˆã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å¼·åŒ–ï¼‰
            const imageElement = document.getElementById('previewImage');
            const placeholder = document.getElementById('imagePlaceholder');
            
            if (sponsor.mainImage && sponsor.mainImage.trim() !== '') {
                try {
                    imageElement.src = sponsor.mainImage;
                    imageElement.onerror = function() {
                        console.log('âš ï¸ ç”»åƒèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼');
                        imageElement.style.display = 'none';
                        placeholder.style.display = 'flex';
                    };
                    imageElement.onload = function() {
                        imageElement.style.display = 'block';
                        placeholder.style.display = 'none';
                    };
                } catch (error) {
                    console.error('ç”»åƒå‡¦ç†ã‚¨ãƒ©ãƒ¼:', error);
                    imageElement.style.display = 'none';
                    placeholder.style.display = 'flex';
                }
            } else {
                imageElement.style.display = 'none';
                placeholder.style.display = 'flex';
            }

            // ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆ
            if (sponsor.website && sponsor.website.trim() !== '') {
                document.getElementById('previewWebsite').innerHTML = 
                    `<p><i class="bi bi-globe"></i> <a href="${sponsor.website}" target="_blank" class="text-decoration-none">${sponsor.website}</a></p>`;
            }

            // å–¶æ¥­æ™‚é–“
            const businessHours = sponsor.openTime || 'å–¶æ¥­æ™‚é–“æœªè¨­å®š';
            const holidays = sponsor.holidays || 'å®šä¼‘æ—¥æœªè¨­å®š';
            
            document.getElementById('previewBusinessHours').textContent = businessHours;
            document.getElementById('previewHolidays').textContent = `å®šä¼‘æ—¥: ${holidays}`;

            // åº—èˆ—èª¬æ˜
            if (sponsor.detailedDescription && sponsor.detailedDescription.trim() !== '') {
                document.getElementById('previewDescription').textContent = sponsor.detailedDescription;
            } else {
                document.getElementById('descriptionSection').style.display = 'none';
            }

            // å¯¾å¿œè¨€èª
            if (sponsor.languages && sponsor.languages.length > 0) {
                const languageText = sponsor.languages.join(', ');
                document.getElementById('previewLanguages').textContent = languageText;
            } else {
                document.getElementById('languagesSection').style.display = 'none';
            }

            // TomoTripç‰¹å…¸
            if (sponsor.detailedDiscount && sponsor.detailedDiscount.trim() !== '') {
                document.getElementById('previewBenefits').textContent = sponsor.detailedDiscount;
            } else {
                document.getElementById('benefitsSection').style.display = 'none';
            }
        }

        function showError(message) {
            document.body.innerHTML = `
                <div class="container mt-5">
                    <div class="alert alert-warning text-center">
                        <h4><i class="bi bi-exclamation-triangle"></i> ã‚¨ãƒ©ãƒ¼</h4>
                        <p>${message}</p>
                        <p>ç·¨é›†ãƒšãƒ¼ã‚¸ã«æˆ»ã£ã¦ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã—ã¦ã‹ã‚‰ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã—ã¦ãã ã•ã„ã€‚</p>
                        <button class="btn btn-primary" onclick="goBackToEdit()">
                            <i class="bi bi-arrow-left"></i> ç·¨é›†ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹
                        </button>
                    </div>
                </div>
            `;
        }

        function goBackToEdit() {
            if (window.opener && !window.opener.closed) {
                window.close();
                window.opener.focus();
            } else {
                window.location.href = `sponsor-edit.html?id=${sponsorId}`;
            }
        }

        function toggleListView() {
            const btn = event.target;
            btn.innerHTML = '<i class="bi bi-list"></i> è¡¨ç¤ºåˆ‡æ›¿ä¸­...';
            btn.disabled = true;
            
            setTimeout(() => {
                btn.innerHTML = '<i class="bi bi-list"></i> ä¸€è¦§è¡¨ç¤º';
                btn.disabled = false;
            }, 1000);
        }

        function publishToList() {
            if (confirm('ã“ã®å†…å®¹ã§å”è³›åº—ä¸€è¦§ã«å…¬é–‹ã—ã¾ã™ã‹ï¼Ÿ')) {
                try {
                    // å…¬é–‹å‡¦ç†
                    const sponsor = JSON.parse(localStorage.getItem(`preview_${sponsorId}`) || '{}');
                    sponsor.published = true;
                    sponsor.publishedDate = new Date().toISOString();
                    
                    // è¤‡æ•°ã®å ´æ‰€ã«ä¿å­˜
                    localStorage.setItem(`store_${sponsorId}`, JSON.stringify(sponsor));
                    
                    const registeredSponsors = JSON.parse(localStorage.getItem('registeredSponsors') || '[]');
                    const index = registeredSponsors.findIndex(s => s.id === sponsorId);
                    if (index !== -1) {
                        registeredSponsors[index] = sponsor;
                    } else {
                        registeredSponsors.push(sponsor);
                    }
                    localStorage.setItem('registeredSponsors', JSON.stringify(registeredSponsors));
                    
                    alert('å”è³›åº—ä¸€è¦§ã«å…¬é–‹ã•ã‚Œã¾ã—ãŸï¼');
                    window.location.href = 'sponsor-list.html';
                } catch (error) {
                    console.error('å…¬é–‹ã‚¨ãƒ©ãƒ¼:', error);
                    alert('å…¬é–‹ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚');
                }
            }
        }

        // ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚ã«å®Ÿè¡Œ
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸ” Preview page DOM loaded');
            loadPreview();
        });
    </script>
</body>
</html>