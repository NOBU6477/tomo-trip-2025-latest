<script>
// 最もシンプルなインライン修正
(function() {
  function findOrCreateRegisterButton() {
    // まず既存のボタンを探す
    let registerBtn = document.querySelector('.btn.btn-warning, a.btn-warning');
    
    // ボタンが見つからない場合は作成
    if (!registerBtn) {
      console.log('新規登録ボタンが見つからないため作成します');
      const navbar = document.querySelector('.navbar-nav');
      
      if (navbar) {
        // 新しいボタンを作成
        registerBtn = document.createElement('a');
        registerBtn.href = '#';
        registerBtn.className = 'btn btn-warning btn-sm ms-2';
        registerBtn.textContent = '新規登録';
        
        // ナビバーに追加
        navbar.appendChild(registerBtn);
      }
    }
    
    // ボタンが見つかった/作成された場合、イベントを設定
    if (registerBtn) {
      console.log('登録ボタンを設定します');
      
      // 既存のイベントをクリア
      const newBtn = registerBtn.cloneNode(true);
      if (registerBtn.parentNode) {
        registerBtn.parentNode.replaceChild(newBtn, registerBtn);
      }
      
      // 新しいイベントを設定
      newBtn.onclick = function(e) {
        e.preventDefault();
        console.log('新規登録ボタンがクリックされました');
        
        // モーダル表示
        const userTypeModal = document.getElementById('userTypeModal');
        if (userTypeModal) {
          // 他のモーダルを閉じる
          document.querySelectorAll('.modal.show').forEach(function(modal) {
            modal.classList.remove('show');
            modal.style.display = 'none';
          });
          
          // バックドロップをクリア
          document.querySelectorAll('.modal-backdrop').forEach(function(el) {
            el.parentNode.removeChild(el);
          });
          
          // 新しいバックドロップを作成
          const backdrop = document.createElement('div');
          backdrop.className = 'modal-backdrop fade show';
          backdrop.style.opacity = '0.25';
          document.body.appendChild(backdrop);
          
          // モーダルを表示
          userTypeModal.classList.add('show');
          userTypeModal.style.display = 'block';
          userTypeModal.setAttribute('aria-modal', 'true');
          userTypeModal.removeAttribute('aria-hidden');
          
          document.body.classList.add('modal-open');
        }
        
        return false;
      };
    }
  }
  
  // DOMContentLoadedとwindow.loadの両方で実行
  document.addEventListener('DOMContentLoaded', findOrCreateRegisterButton);
  window.addEventListener('load', findOrCreateRegisterButton);
})();
</script>
