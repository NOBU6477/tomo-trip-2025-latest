<style>
/* モーダル表示時の背景を暗く */
body.modal-open .modal {
  background-color: rgba(0, 0, 0, 0.5) !important;
}

/* モーダルのZ-indexを調整 */
.modal-backdrop {
  z-index: 1040 !important;
}

.modal-dialog {
  z-index: 1050 !important;
  margin: 1.75rem auto !important;
}

/* モーダルのコンテンツスタイル */
.modal-content {
  box-shadow: 0 0 15px rgba(0, 0, 0, 0.5) !important;
}
</style>

<script>
// モーダルフィクサー
function fixModalDisplayIssues() {
  // モーダルが表示された時の処理
  document.addEventListener('shown.bs.modal', function(e) {
    // 背景をすべて削除
    document.querySelectorAll('.modal-backdrop').forEach(function(el, index) {
      if (index > 0) {
        el.remove();
      }
    });
    
    // bodyにスタイルを追加
    document.body.classList.add('modal-open');
    document.body.style.overflow = 'hidden';
    
    // モーダルの背景色を設定
    e.target.style.backgroundColor = 'rgba(0, 0, 0, 0.5)';
  });
  
  // モーダルが閉じられた時の処理
  document.addEventListener('hidden.bs.modal', function(e) {
    // 他にモーダルが表示されていなければbodyのスタイルをリセット
    const visibleModals = document.querySelectorAll('.modal.show');
    if (visibleModals.length === 0) {
      document.body.classList.remove('modal-open');
      document.body.style.overflow = '';
      document.body.style.paddingRight = '';
    }
  });
}

// ページ読み込み時に実行
document.addEventListener('DOMContentLoaded', fixModalDisplayIssues);
</script>
