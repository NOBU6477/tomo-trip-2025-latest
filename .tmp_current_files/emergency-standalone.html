<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>緊急スタンドアロンモード - Local Guide</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
      line-height: 1.6;
      color: #333;
      margin: 0;
      padding: 20px;
      background-color: #f8f9fa;
    }
    .container {
      max-width: 800px;
      margin: 20px auto;
      padding: 20px;
      background-color: white;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    header {
      text-align: center;
      margin-bottom: 30px;
    }
    h1 {
      color: #0066cc;
      margin-bottom: 10px;
    }
    .subtitle {
      color: #666;
      font-size: 1.1rem;
    }
    .card {
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 20px;
    }
    .card-header {
      border-bottom: 1px solid #eee;
      padding-bottom: 10px;
      margin-bottom: 15px;
      font-weight: bold;
      color: #0066cc;
    }
    .controls {
      margin: 20px 0;
      padding: 15px;
      background-color: #f1f8ff;
      border-radius: 8px;
      border: 1px solid #cce5ff;
    }
    button, .btn {
      background-color: #0066cc;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 1rem;
      margin-right: 10px;
      margin-bottom: 10px;
      text-decoration: none;
      display: inline-block;
    }
    button:hover, .btn:hover {
      background-color: #0055aa;
    }
    .btn-secondary {
      background-color: #6c757d;
    }
    .btn-secondary:hover {
      background-color: #5a6268;
    }
    .alert {
      padding: 15px;
      margin-bottom: 20px;
      border: 1px solid transparent;
      border-radius: 5px;
    }
    .alert-info {
      background-color: #e9f2fd;
      border-color: #b8daff;
      color: #004085;
    }
    .alert-warning {
      background-color: #fff3cd;
      border-color: #ffeeba;
      color: #856404;
    }
    .form-group {
      margin-bottom: 15px;
    }
    label {
      display: block;
      margin-bottom: 5px;
      font-weight: 500;
    }
    input[type="text"], textarea, select {
      width: 100%;
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 4px;
      box-sizing: border-box;
      font-family: inherit;
      font-size: 1rem;
    }
    .options {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin: 20px 0;
    }
    .tag {
      display: inline-block;
      background-color: #e9f2fd;
      color: #0066cc;
      padding: 5px 10px;
      border-radius: 15px;
      font-size: 0.9rem;
      margin-right: 5px;
      margin-bottom: 5px;
    }
    .footer {
      margin-top: 30px;
      padding-top: 20px;
      border-top: 1px solid #eee;
      text-align: center;
      color: #666;
      font-size: 0.9rem;
    }
    
    /* モバイル対応 */
    @media (max-width: 768px) {
      .container {
        padding: 15px;
      }
      button, .btn {
        width: 100%;
        margin-right: 0;
      }
      .options {
        flex-direction: column;
      }
    }
  </style>
  
  <!-- 応答なしダイアログの自動クリックスクリプト -->
  <script>
    (function() {
      console.log('緊急スタンドアロンモード: 応答なしダイアログ自動クリック機能を初期化');
      
      // 定期的なチェック
      let checkInterval = null;
      
      // 自動クリック機能を有効化
      function enableAutoClick() {
        if (checkInterval) return; // 既に実行中なら何もしない
        
        // 50ミリ秒ごとにボタンをチェック
        checkInterval = setInterval(() => {
          try {
            const buttons = document.querySelectorAll('button');
            for (let i = 0; i < buttons.length; i++) {
              const btn = buttons[i];
              const text = btn && btn.textContent ? btn.textContent.toLowerCase() : '';
              
              if (text.includes('待機') || text.includes('wait') || 
                  text.includes('待つ') || text.includes('continue')) {
                console.log('「待機」ボタンを自動クリックします', text);
                setTimeout(() => btn.click(), 10);
                break;
              }
            }
          } catch (e) {
            // エラーは無視
          }
        }, 50);
        
        // 状態を記録
        localStorage.setItem('autoClickEnabled', 'true');
        document.getElementById('statusText').textContent = '有効';
        document.getElementById('toggleBtn').textContent = '無効にする';
      }
      
      // 自動クリック機能を無効化
      function disableAutoClick() {
        if (checkInterval) {
          clearInterval(checkInterval);
          checkInterval = null;
        }
        
        // 状態を記録
        localStorage.setItem('autoClickEnabled', 'false');
        document.getElementById('statusText').textContent = '無効';
        document.getElementById('toggleBtn').textContent = '有効にする';
      }
      
      // 切り替え関数
      window.toggleAutoClick = function() {
        const isEnabled = localStorage.getItem('autoClickEnabled') === 'true';
        if (isEnabled) {
          disableAutoClick();
        } else {
          enableAutoClick();
        }
      };
      
      // 初期状態を設定
      document.addEventListener('DOMContentLoaded', function() {
        const autoClickDefault = true; // デフォルトは有効
        const isEnabled = localStorage.getItem('autoClickEnabled');
        
        if (isEnabled === null) {
          // 初めての場合はデフォルト値を使用
          if (autoClickDefault) {
            enableAutoClick();
          } else {
            disableAutoClick();
          }
        } else if (isEnabled === 'true') {
          enableAutoClick();
        } else {
          disableAutoClick();
        }
      });
      
      // 即時実行も行う
      setTimeout(() => {
        const autoClickDefault = true;
        if (autoClickDefault) {
          enableAutoClick();
        }
      }, 100);
    })();
  </script>
</head>
<body>
  <div class="container">
    <header>
      <h1>Local Guide - 緊急スタンドアロンモード</h1>
      <div class="subtitle">このページは特別な緊急モードでLocal Guideにアクセスするためのページです</div>
    </header>
    
    <div class="alert alert-info">
      <strong>このページについて:</strong> このページはReplitプレビュー環境での動作問題を回避するための特別なアクセス方法を提供します。ローカルでダウンロードして使用することもできます。
    </div>
    
    <div class="card">
      <div class="card-header">応答なしダイアログ自動クリック機能</div>
      <p>「このページは応答していません」というダイアログが表示されたとき、自動的に「待機」ボタンをクリックする機能です。</p>
      <div class="controls">
        <p>現在の状態: <strong id="statusText">読み込み中...</strong></p>
        <button id="toggleBtn" onclick="toggleAutoClick()">切り替え</button>
      </div>
    </div>
    
    <div class="card">
      <div class="card-header">アクセス方法の選択</div>
      <p>以下のアクセス方法から選択してください：</p>
      <div class="options">
        <a href="https://local-guide-new.jrgwtjgmb39.repl.co/?mode=simple" target="_blank" class="btn">シンプルモード</a>
        <a href="https://local-guide-new.jrgwtjgmb39.repl.co/?debug=true" target="_blank" class="btn">デバッグモード</a>
        <a href="https://local-guide-new.jrgwtjgmb39.repl.co/direct" target="_blank" class="btn">直接表示モード</a>
        <a href="https://local-guide-new.jrgwtjgmb39.repl.co/force-direct" target="_blank" class="btn">強制直接モード</a>
        <a href="https://local-guide-new.jrgwtjgmb39.repl.co/auto-wait" target="_blank" class="btn">自動待機モード</a>
      </div>
    </div>
    
    <div class="card">
      <div class="card-header">特別アクセスオプション</div>
      <p>以下のURLを直接開くこともできます：</p>
      <div class="form-group">
        <input type="text" id="directUrl" value="https://local-guide-new.jrgwtjgmb39.repl.co/?force_direct=true&no_response_handler=true&no_spinner=true&extreme=true" readonly>
        <button onclick="copyUrl()">URLをコピー</button>
        <button onclick="openUrl()">新しいタブで開く</button>
      </div>
    </div>
    
    <div class="alert alert-warning">
      <strong>注意:</strong> それでも問題が解決しない場合は、ブラウザのキャッシュをクリアするか、別のブラウザを試してみてください。
    </div>
    
    <div class="footer">
      <p>このページはLocal Guideアプリケーションの緊急アクセス用に作成されたスタンドアロンページです。</p>
      <p>問題が解決しない場合は、管理者にお問い合わせください。</p>
    </div>
  </div>
  
  <script>
    // URLコピー機能
    function copyUrl() {
      const urlInput = document.getElementById('directUrl');
      urlInput.select();
      document.execCommand('copy');
      alert('URLをコピーしました');
    }
    
    // URLを開く機能
    function openUrl() {
      const url = document.getElementById('directUrl').value;
      window.open(url, '_blank');
    }
  </script>
</body>
</html>