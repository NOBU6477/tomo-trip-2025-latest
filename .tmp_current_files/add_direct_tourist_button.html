<script>
// 観光客本人確認ボタン用ヘルパー関数
document.addEventListener('DOMContentLoaded', function() {
  const touristUploadBtn = document.getElementById('tourist-upload-id');
  if (touristUploadBtn) {
    // すでに設定されているイベントを全て削除
    const newBtn = touristUploadBtn.cloneNode(true);
    if (touristUploadBtn.parentNode) {
      touristUploadBtn.parentNode.replaceChild(newBtn, touristUploadBtn);
    }
    
    // 新しい直接HTML方式のボタンイベント
    newBtn.addEventListener('click', function(e) {
      e.preventDefault();
      
      // 観光客登録モーダルを閉じる
      const touristModal = document.getElementById('touristRegisterModal');
      if (touristModal) {
        touristModal.classList.remove('show');
        touristModal.style.display = 'none';
        touristModal.setAttribute('aria-hidden', 'true');
        touristModal.removeAttribute('aria-modal');
      }
      
      // バックドロップを削除
      document.querySelectorAll('.modal-backdrop').forEach(function(el) {
        document.body.removeChild(el);
      });
      
      // bodyスタイルをリセット
      document.body.classList.remove('modal-open');
      
      // 少し待ってから本人確認モーダルを表示
      setTimeout(function() {
        const idModal = document.getElementById('idDocumentModal');
        if (idModal) {
          // ユーザータイプを設定
          let typeField = idModal.querySelector('input[name="user-type"]');
          if (!typeField) {
            typeField = document.createElement('input');
            typeField.type = 'hidden';
            typeField.name = 'user-type';
            idModal.querySelector('form').appendChild(typeField);
          }
          typeField.value = 'tourist';
          
          // モーダルを直接表示
          const backdrop = document.createElement('div');
          backdrop.className = 'modal-backdrop fade show';
          document.body.appendChild(backdrop);
          
          idModal.classList.add('show');
          idModal.style.display = 'block';
          idModal.setAttribute('aria-modal', 'true');
          idModal.removeAttribute('aria-hidden');
          
          document.body.classList.add('modal-open');
        } else {
          alert('身分証明書モーダルが見つかりません');
        }
      }, 300);
      
      return false;
    });
  }
});
</script>
