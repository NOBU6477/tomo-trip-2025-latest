<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Local Guide - 特別な旅の体験を</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
  <link href="login-modal-styles.css" rel="stylesheet">
  <style>
    body {
      background-color: #f8f9fa;
    }
    .navbar-brand {
      font-weight: bold;
    }
    .modal-content {
      border-radius: 0.5rem;
    }
    .section-title {
      border-bottom: 2px solid #0d6efd;
      padding-bottom: 0.5rem;
      margin-bottom: 1rem;
    }
    
    /* 新規登録ドロップダウンのスタイル */
    .register-dropdown {
      width: 100%;
      max-width: 320px;
      padding: 0.5rem;
      border-radius: 10px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      animation: fadeInDown 0.3s ease;
      left: auto !important;
      right: 0 !important;
    }
    
    .dropdown-item {
      border-radius: 8px;
      padding: 12px 15px;
      transition: all 0.2s ease;
    }
    
    .dropdown-item:hover {
      background-color: #f0f7ff;
      transform: translateY(-2px);
    }
    
    .register-dropdown {
      min-width: 320px;
      border: 1px solid rgba(0,0,0,0.05);
      box-shadow: 0 8px 25px rgba(0,0,0,0.15);
      border-radius: 8px;
      padding: 8px 0;
      margin-top: 10px;
      background: white;
    }
    
    .register-dropdown .dropdown-item {
      padding: 12px 16px;
      border: none;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      text-decoration: none;
    }
    
    .register-dropdown .dropdown-item:hover {
      background-color: #f8f9fa;
      border-radius: 0;
    }
    
    .register-dropdown .dropdown-item:focus {
      background-color: #f8f9fa;
      box-shadow: none;
    }
    
    .register-icon {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 40px;
      height: 40px;
      border-radius: 8px;
      font-size: 1.2rem;
      margin-right: 12px;
      flex-shrink: 0;
    }
    
    .tourist-icon {
      background-color: #e3f2fd;
      color: #1976d2;
    }
    
    .guide-icon {
      background-color: #e8f5e8;
      color: #388e3c;
    }
    
    .dropdown-divider {
      margin: 8px 16px;
      border-color: #e9ecef;
    }
    
    .register-dropdown .fw-bold {
      font-weight: 600;
      color: #212529;
      margin-bottom: 2px;
      font-size: 14px;
    }
    
    .register-dropdown .text-muted {
      font-size: 12px;
      color: #6c757d !important;
      line-height: 1.3;
      margin: 0;
    }
    
    .register-dropdown > li > .dropdown-item > div:last-child {
      flex: 1;
    }
    
    @keyframes fadeInDown {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    .phone-section {
      background-color: #f8f9fa;
      border: 1px solid #dee2e6;
      border-radius: 0.375rem;
      padding: 1.5rem;
      margin: 1rem 0;
    }
    .hero-section {
      background-image: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url('https://source.unsplash.com/random/1200x800/?japan,travel');
      background-size: cover;
      background-position: center;
      color: white;
      padding: 5rem 0;
      margin-bottom: 2rem;
    }
    .guide-card {
      transition: transform 0.3s;
      margin-bottom: 1.5rem;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 3px 10px rgba(0,0,0,0.1);
    }
    .guide-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }
    .guide-image {
      height: 250px;
      object-fit: cover;
      object-position: center;
      border-bottom: 1px solid #eee;
      transition: transform 0.5s ease;
      filter: brightness(0.95);
    }
    .guide-card:hover .guide-image {
      transform: scale(1.05);
      filter: brightness(1.05);
    }
    .badge-verified {
      background-color: #28a745;
      color: white;
      font-size: 0.7rem;
      padding: 0.25rem 0.5rem;
      border-radius: 0.25rem;
      margin-left: 0.5rem;
    }
    /* 認証ボタンのパルスアニメーション */
    .btn-pulse {
      animation: pulse 1.5s infinite;
    }
    @keyframes pulse {
      0% {
        box-shadow: 0 0 0 0 rgba(40, 167, 69, 0.7);
      }
      70% {
        box-shadow: 0 0 0 10px rgba(40, 167, 69, 0);
      }
      100% {
        box-shadow: 0 0 0 0 rgba(40, 167, 69, 0);
      }
    }
    /* 認証ボタンのスタイル */
    #tourist-verify-code-btn,
    #guide-verify-code-btn {
      width: 100%;
      margin-top: 0.5rem;
      transition: all 0.3s ease;
    }
    /* 身分証明書プレビュー */
    .document-preview-container {
      min-height: 50px;
    }
    .document-preview img {
      max-height: 200px;
      width: auto;
      border: 1px solid #dee2e6;
    }
    /* 非表示ガイド用のスタイル */
    .hidden-guide {
      display: none;
    }
    
    /* フィルター関連のスタイル */
    /* 検索結果カウンターの強化スタイル */
    #search-results-counter {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      font-size: 1.2rem;
      font-weight: 700;
      padding: 1rem 2rem;
      border-radius: 50px;
      text-align: center;
      margin: 1.5rem auto;
      max-width: 400px;
      box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
      position: relative;
      overflow: hidden;
      animation: counterPulse 2s ease-in-out infinite alternate;
    }
    
    #search-results-counter::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
      transform: rotate(45deg);
      animation: shimmer 3s ease-in-out infinite;
    }
    
    #search-results-counter::after {
      content: '🔍';
      position: absolute;
      left: 1.2rem;
      top: 50%;
      transform: translateY(-50%);
      font-size: 1.2rem;
      opacity: 0.7;
      z-index: 1;
    }
    
    #search-results-counter {
      padding-left: 3rem !important;
      z-index: 2;
      position: relative;
    }
    
    @keyframes counterPulse {
      0% {
        transform: scale(1);
        box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
      }
      100% {
        transform: scale(1.02);
        box-shadow: 0 12px 35px rgba(102, 126, 234, 0.4);
      }
    }
    
    @keyframes shimmer {
      0% {
        transform: translateX(-100%) translateY(-100%) rotate(45deg);
      }
      100% {
        transform: translateX(100%) translateY(100%) rotate(45deg);
      }
    }
    
    /* モバイル対応 */
    @media (max-width: 768px) {
      #search-results-counter {
        font-size: 1rem;
        padding: 0.8rem 1.5rem;
        margin: 1rem auto;
      }
      
      #search-results-counter::after {
        font-size: 1.2rem;
        left: 0.8rem;
      }
    }
    
    /* 強化されたガイドカードデザイン */
    .guide-card {
      transition: all 0.3s ease;
      border: 2px solid transparent;
      border-radius: 15px !important;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12);
      background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
      overflow: hidden;
      position: relative;
    }
    
    .guide-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
      z-index: 1;
    }
    
    .guide-card:hover {
      transform: translateY(-8px) scale(1.02);
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
      border-color: #667eea;
    }
    
    .guide-card .card-img-top {
      height: 220px;
      object-fit: cover;
      transition: transform 0.3s ease;
    }
    
    .guide-card:hover .card-img-top {
      transform: scale(1.05);
    }
    
    .guide-card .card-body {
      padding: 1.5rem;
      position: relative;
      z-index: 2;
    }
    
    .guide-card .card-title {
      font-size: 1.3rem;
      font-weight: 700;
      color: #2c3e50;
      margin-bottom: 0.8rem;
    }
    
    .guide-card .badge.bg-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
      font-size: 0.9rem;
      padding: 0.5rem 1rem;
      border-radius: 20px;
      font-weight: 600;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
    }
    
    .guide-card .guide-location {
      font-size: 1rem;
      color: #6c757d;
      font-weight: 500;
    }
    
    .guide-card .guide-location i {
      color: #667eea;
      font-size: 1.1rem;
    }
    
    .guide-card .card-text {
      font-size: 0.95rem;
      line-height: 1.6;
      color: #495057;
    }
    
    .guide-card .badge.bg-light {
      background: #e3f2fd !important;
      color: #1976d2 !important;
      font-weight: 500;
      border: 1px solid #bbdefb;
    }
    
    .guide-card .text-warning i {
      color: #ffc107 !important;
      text-shadow: 0 1px 3px rgba(255, 193, 7, 0.3);
    }
    
    .guide-card .btn-outline-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border: none;
      color: white;
      font-weight: 600;
      padding: 0.75rem 1.5rem;
      border-radius: 25px;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
    }
    
    .guide-card .btn-outline-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
      background: linear-gradient(135deg, #5a6fd8 0%, #6a42a6 100%);
    }
    
    /* ガイドセクション全体の強化 */
    #guides {
      background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
      border-radius: 20px;
      padding: 3rem 2rem;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
      margin: 2rem 0;
    }
    
    #guides h2 {
      font-size: 2.5rem;
      font-weight: 800;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      margin-bottom: 2rem;
    }
    
    .guide-item {
      margin-bottom: 2rem;
      animation: slideInUp 0.6s ease-out forwards;
      opacity: 0;
      transform: translateY(30px);
    }
    
    .guide-item:nth-child(1) { animation-delay: 0.1s; }
    .guide-item:nth-child(2) { animation-delay: 0.2s; }
    .guide-item:nth-child(3) { animation-delay: 0.3s; }
    .guide-item:nth-child(4) { animation-delay: 0.4s; }
    .guide-item:nth-child(5) { animation-delay: 0.5s; }
    .guide-item:nth-child(6) { animation-delay: 0.6s; }

    @keyframes slideInUp {
      0% {
        opacity: 0;
        transform: translateY(30px);
      }
      100% {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .guide-filter-fadeIn {
      animation: fadeIn 0.4s ease-out forwards;
    }
    
    /* 「もっと見る」ボタンの強化 */
    #load-more-guides {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border: none;
      color: white;
      font-weight: 600;
      padding: 1rem 2.5rem;
      border-radius: 30px;
      font-size: 1.1rem;
      transition: all 0.3s ease;
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.3);
      margin: 2rem auto;
      display: block;
    }
    
    #load-more-guides:hover {
      transform: translateY(-3px);
      box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
      background: linear-gradient(135deg, #5a6fd8 0%, #6a42a6 100%);
    }
    
    /* プロフィール写真スタイル */
    .profile-photo-container {
      position: relative;
      width: 150px;
      height: 150px;
      overflow: hidden;
      cursor: pointer;
    }
    
    .profile-photo {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: all 0.3s ease;
    }
    
    .profile-photo-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.3);
      display: flex;
      justify-content: center;
      align-items: center;
      opacity: 0;
      transition: opacity 0.3s ease;
      border-radius: 50%;
    }
    
    .profile-photo-overlay i {
      color: white;
      font-size: 2rem;
    }
    
    .profile-photo-container:hover .profile-photo-overlay {
      opacity: 1;
    }
    
    .profile-photo-container:hover .profile-photo {
      transform: scale(1.05);
    }
    
    /* モバイル端末のみカメラ機能表示 */
    @media (min-width: 768px) {
      .mobile-only {
        display: none !important;
      }
    }

    /* 協賛店広告バナー - 右から左へのスクロール */
    .sponsor-banner {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      padding: 15px 0;
      overflow: hidden;
      position: relative;
      white-space: nowrap;
      border-bottom: 3px solid #4f46e5;
    }

    .sponsor-scroll {
      display: inline-block;
      animation: scrollRight 30s linear infinite;
      white-space: nowrap;
    }

    .sponsor-item {
      display: inline-block;
      background: rgba(255, 255, 255, 0.95);
      margin: 0 20px;
      padding: 8px 20px;
      border-radius: 25px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
      transition: transform 0.3s ease;
      vertical-align: middle;
    }

    .sponsor-item:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 25px rgba(0, 0, 0, 0.15);
    }

    .sponsor-logo {
      height: 30px;
      width: auto;
      margin-right: 10px;
      vertical-align: middle;
    }

    .sponsor-text {
      color: #333;
      font-weight: 600;
      font-size: 14px;
      vertical-align: middle;
    }

    .sponsor-offer {
      background: #ff6b6b;
      color: white;
      padding: 2px 8px;
      border-radius: 12px;
      font-size: 11px;
      margin-left: 8px;
      font-weight: bold;
    }

    @keyframes scrollRight {
      0% {
        transform: translateX(100%);
      }
      100% {
        transform: translateX(-100%);
      }
    }

    /* モバイル対応 */
    @media (max-width: 768px) {
      .sponsor-banner {
        padding: 10px 0;
      }
      
      .sponsor-item {
        margin: 0 15px;
        padding: 6px 15px;
      }
      
      .sponsor-text {
        font-size: 12px;
      }
      
      .sponsor-logo {
        height: 25px;
      }
      
      .sponsor-offer {
        font-size: 10px;
        padding: 1px 6px;
      }
    }

    /* アニメーション一時停止（ホバー時） */
    .sponsor-banner:hover .sponsor-scroll {
      animation-play-state: paused;
    }
  </style>
</head>
<body>
  <!-- アラートコンテナ -->
  <div id="alert-container" style="position: fixed; top: 20px; right: 20px; max-width: 400px; z-index: 9999;"></div>
  
  <!-- ナビゲーションバー -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container">
      <a class="navbar-brand" href="#">
        TomoTrip
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav me-auto">
          <li class="nav-item">
            <a class="nav-link active" href="#">ホーム</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#guides">ガイドを探す</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#how-it-works">使い方</a>
          </li>
        </ul>
        
        <div class="dropdown me-3">
          <button class="btn btn-outline-light dropdown-toggle" id="languageDropdown" data-bs-toggle="dropdown">
            日本語
          </button>
          <ul class="dropdown-menu dropdown-menu-end">
            <li><a class="dropdown-item" href="#" data-lang="ja">日本語</a></li>
            <li><a class="dropdown-item" href="#" data-lang="en">English</a></li>
          </ul>
        </div>
        
        <!-- ユーザーメニューエリア - 未ログイン時のみ表示 -->
        <div id="navbar-user-area">
          <button class="btn btn-outline-light me-2" data-bs-toggle="modal" data-bs-target="#loginModal">ログイン</button>
          
          <!-- 新規登録ドロップダウン -->
          <div class="dropdown d-inline-block">
            <button class="btn btn-light dropdown-toggle" id="registerDropdown" data-bs-toggle="dropdown" aria-expanded="false">
              新規登録
            </button>
            <ul class="dropdown-menu dropdown-menu-end register-dropdown" aria-labelledby="registerDropdown">
              <li>
                <button class="dropdown-item" type="button" data-bs-toggle="modal" data-bs-target="#registerTouristModal">
                  <div class="register-icon tourist-icon">
                    <i class="bi bi-person"></i>
                  </div>
                  <div>
                    <div class="fw-bold">旅行者として登録</div>
                    <div class="text-muted">ローカルガイドと一緒に特別な旅を体験</div>
                  </div>
                </button>
              </li>
              <li><hr class="dropdown-divider"></li>
              <li>
                <button class="dropdown-item" type="button" data-bs-toggle="modal" data-bs-target="#registerGuideModal">
                  <div class="register-icon guide-icon">
                    <i class="bi bi-map"></i>
                  </div>
                  <div>
                    <div class="fw-bold">ガイドとして登録</div>
                    <div class="text-muted">あなたの知識と経験を共有しましょう</div>
                  </div>
                </button>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </nav>

  <!-- ヒーローセクション -->
  <section class="hero-section text-center text-white py-5" style="
    background: linear-gradient(rgba(66, 135, 245, 0.4), rgba(224, 79, 158, 0.4)), 
                url('attached_assets/IMG20221024140826_1750355257888.jpg') center/cover;
    position: relative; 
    overflow: hidden;
    min-height: 60vh;
  ">
    <!-- 装飾要素 -->
    <div style="position: absolute; width: 100%; height: 100%; top: 0; left: 0; overflow: hidden; opacity: 0.3;">
      <svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg" style="position: absolute; width: 300px; height: 300px; top: -50px; left: -50px;">
        <path fill="#FFFFFF" d="M44.7,-76.4C58.8,-69.2,71.8,-59.1,79.6,-45.5C87.4,-31.9,90.2,-15.9,88.1,-1.2C86,13.5,79.1,27,70.8,39.4C62.5,51.8,52.7,63.1,40.4,70.4C28.1,77.8,14.1,81.1,-0.3,81.6C-14.7,82.1,-29.3,79.9,-41,72.5C-52.6,65.2,-61.3,52.8,-68.9,39.7C-76.6,26.6,-83.3,13.3,-84.7,-0.8C-86,-14.9,-82,-29.9,-73.6,-41.5C-65.2,-53.1,-52.5,-61.4,-39.3,-68.7C-26.1,-76,-13.1,-82.3,1.1,-84.1C15.2,-85.8,30.5,-83.7,44.7,-76.4Z" transform="translate(100 100)" />
      </svg>
      <svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg" style="position: absolute; width: 400px; height: 400px; bottom: -150px; right: -100px;">
        <path fill="#FFFFFF" d="M34.6,-59.1C43.5,-53.8,48.7,-41.8,55.8,-30.2C62.8,-18.6,71.7,-7.3,73,5.1C74.4,17.6,68.3,31.2,58.5,40.1C48.7,48.9,35.3,52.9,22.7,56.7C10.2,60.5,-1.5,63.9,-14.6,63.8C-27.8,63.7,-42.4,60,-50.9,50.7C-59.4,41.3,-61.7,26.3,-65.6,11.3C-69.4,-3.7,-74.7,-18.6,-71.1,-31C-67.5,-43.3,-55,-53,-41.7,-57.8C-28.4,-62.5,-14.2,-62.3,-0.6,-61.3C13,-60.3,25.9,-58.3,34.6,-59.1Z" transform="translate(100 100)" />
      </svg>
    </div>
    <!-- TomoTrip Logo -->
    <div style="position: absolute; top: 2%; left: 2%;">
      <img src="tomotrip-logo.png" alt="TomoTrip" style="width: 180px; height: auto;">
    </div>
    
    <div class="container position-relative">
      <h1 class="display-4 fw-bold mb-3">あなただけの特別な旅を</h1>
      <p class="lead mb-4">地元ガイドと一緒に、観光では見つけられない隠れた魅力を体験しましょう</p>
      <div>
        <a href="#guides" class="btn btn-light btn-lg">ガイドを探す</a>
        <button class="btn btn-outline-light btn-lg ms-2" data-bs-toggle="modal" data-bs-target="#contactModal">お問い合わせ</button>
      </div>
    </div>
  </section>

  <!-- 協賛店広告バナー -->
  <div class="sponsor-banner">
    <div class="sponsor-scroll">
      <div class="sponsor-item">
        <img src="https://images.unsplash.com/photo-1514933651103-005eec06c04b?w=100&h=60&fit=crop" alt="海の家レストラン" class="sponsor-logo" onerror="this.style.display='none'">
        <span class="sponsor-text">海の家レストラン</span>
        <span class="sponsor-offer">20%OFF</span>
      </div>
      <div class="sponsor-item">
        <img src="https://images.unsplash.com/photo-1566073771259-6a8506099945?w=100&h=60&fit=crop" alt="山田温泉ホテル" class="sponsor-logo" onerror="this.style.display='none'">
        <span class="sponsor-text">山田温泉ホテル</span>
        <span class="sponsor-offer">特別価格</span>
      </div>
      <div class="sponsor-item">
        <img src="https://images.unsplash.com/photo-1544620347-c4fd4a3d5957?w=100&h=60&fit=crop" alt="サクラ観光バス" class="sponsor-logo" onerror="this.style.display='none'">
        <span class="sponsor-text">サクラ観光バス</span>
        <span class="sponsor-offer">送迎無料</span>
      </div>
      <div class="sponsor-item">
        <img src="https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=100&h=60&fit=crop" alt="伝統工芸体験館" class="sponsor-logo" onerror="this.style.display='none'">
        <span class="sponsor-text">伝統工芸体験館</span>
        <span class="sponsor-offer">体験割引</span>
      </div>
      <div class="sponsor-item">
        <img src="https://images.unsplash.com/photo-1543083115-638c32cd3d58?w=100&h=60&fit=crop" alt="地元特産品店" class="sponsor-logo" onerror="this.style.display='none'">
        <span class="sponsor-text">地元特産品店</span>
        <span class="sponsor-offer">お土産10%OFF</span>
      </div>
      <div class="sponsor-item">
        <img src="https://images.unsplash.com/photo-1501339847302-ac426a4a7cbb?w=100&h=60&fit=crop" alt="カフェ桜" class="sponsor-logo" onerror="this.style.display='none'">
        <span class="sponsor-text">カフェ桜</span>
        <span class="sponsor-offer">ドリンク1杯無料</span>
      </div>
      <div class="sponsor-item">
        <img src="https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=100&h=60&fit=crop" alt="釣り船太郎" class="sponsor-logo" onerror="this.style.display='none'">
        <span class="sponsor-text">釣り船太郎</span>
        <span class="sponsor-offer">初回半額</span>
      </div>
      <div class="sponsor-item">
        <img src="https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=100&h=60&fit=crop" alt="レンタル自転車" class="sponsor-logo" onerror="this.style.display='none'">
        <span class="sponsor-text">レンタル自転車</span>
        <span class="sponsor-offer">1日レンタル</span>
      </div>
      <!-- 繰り返し表示でシームレスなループを作成 -->
      <div class="sponsor-item">
        <img src="https://images.unsplash.com/photo-1514933651103-005eec06c04b?w=100&h=60&fit=crop" alt="海の家レストラン" class="sponsor-logo" onerror="this.style.display='none'">
        <span class="sponsor-text">海の家レストラン</span>
        <span class="sponsor-offer">20%OFF</span>
      </div>
      <div class="sponsor-item">
        <img src="https://images.unsplash.com/photo-1566073771259-6a8506099945?w=100&h=60&fit=crop" alt="山田温泉ホテル" class="sponsor-logo" onerror="this.style.display='none'">
        <span class="sponsor-text">山田温泉ホテル</span>
        <span class="sponsor-offer">特別価格</span>
      </div>
      <div class="sponsor-item">
        <img src="https://images.unsplash.com/photo-1544620347-c4fd4a3d5957?w=100&h=60&fit=crop" alt="サクラ観光バス" class="sponsor-logo" onerror="this.style.display='none'">
        <span class="sponsor-text">サクラ観光バス</span>
        <span class="sponsor-offer">送迎無料</span>
      </div>
      <div class="sponsor-item">
        <img src="https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=100&h=60&fit=crop" alt="伝統工芸体験館" class="sponsor-logo" onerror="this.style.display='none'">
        <span class="sponsor-text">伝統工芸体験館</span>
        <span class="sponsor-offer">体験割引</span>
      </div>
      <div class="sponsor-item">
        <img src="https://images.unsplash.com/photo-1543083115-638c32cd3d58?w=100&h=60&fit=crop" alt="地元特産品店" class="sponsor-logo" onerror="this.style.display='none'">
        <span class="sponsor-text">地元特産品店</span>
        <span class="sponsor-offer">お土産10%OFF</span>
      </div>
      <div class="sponsor-item">
        <img src="https://images.unsplash.com/photo-1501339847302-ac426a4a7cbb?w=100&h=60&fit=crop" alt="カフェ桜" class="sponsor-logo" onerror="this.style.display='none'">
        <span class="sponsor-text">カフェ桜</span>
        <span class="sponsor-offer">ドリンク1杯無料</span>
      </div>
      <div class="sponsor-item">
        <img src="https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=100&h=60&fit=crop" alt="釣り船太郎" class="sponsor-logo" onerror="this.style.display='none'">
        <span class="sponsor-text">釣り船太郎</span>
        <span class="sponsor-offer">初回半額</span>
      </div>
      <div class="sponsor-item">
        <img src="https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=100&h=60&fit=crop" alt="レンタル自転車" class="sponsor-logo" onerror="this.style.display='none'">
        <span class="sponsor-text">レンタル自転車</span>
        <span class="sponsor-offer">1日レンタル</span>
      </div>
    </div>
  </div>

  <!-- メインコンテンツ -->
  <div class="container py-5">
    <!-- 人気のガイド -->
    <section id="guides" class="mb-5">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <div class="position-relative">
          <button type="button" class="btn btn-sm btn-outline-info me-3" id="filter-tutorial-btn" style="border-radius: 20px;">
            <i class="bi bi-question-circle me-1"></i>フィルターの使い方
          </button>
        </div>
        <h2 class="mb-0 flex-grow-1 text-center">人気のガイド</h2>
        <div style="width: 140px;"></div> <!-- スペーサー -->
      </div>
      <div class="mb-4">
        <div id="search-results-counter"></div>
        <div id="no-results-message" class="alert alert-info text-center my-4 d-none">検索条件に一致するガイドが見つかりませんでした。条件を変更してお試しください。</div>
        
        <!-- フィルター切り替えボタン -->
        <div class="text-center mb-3">
          <button type="button" class="btn btn-outline-primary" id="toggle-filter-button">
            <i class="bi bi-funnel"></i> ガイドを絞り込み
          </button>
        </div>
        
        <div class="row justify-content-center">
          <div class="col-md-10 col-lg-8">
            <div class="card shadow-sm d-none" id="filter-card">
              <div class="card-body">
                <h5 class="card-title mb-3">ガイドを絞り込む</h5>
                <form id="guide-filter-form">
                  <!-- リアルタイム検索フィルターフォーム -->
                  <div class="row g-3">
                    <div class="col-md-4">
                      <label for="location-filter" class="form-label">地域</label>
                      <select class="form-select" id="location-filter">
                        <option value="">すべて</option>
                        <optgroup label="都道府県">
                          <option value="北海道">北海道</option>
                          <option value="青森県">青森県</option>
                          <option value="岩手県">岩手県</option>
                          <option value="宮城県">宮城県</option>
                          <option value="秋田県">秋田県</option>
                          <option value="山形県">山形県</option>
                          <option value="福島県">福島県</option>
                          <option value="茨城県">茨城県</option>
                          <option value="栃木県">栃木県</option>
                          <option value="群馬県">群馬県</option>
                          <option value="埼玉県">埼玉県</option>
                          <option value="千葉県">千葉県</option>
                          <option value="東京都">東京都</option>
                          <option value="神奈川県">神奈川県</option>
                          <option value="新潟県">新潟県</option>
                          <option value="富山県">富山県</option>
                          <option value="石川県">石川県</option>
                          <option value="福井県">福井県</option>
                          <option value="山梨県">山梨県</option>
                          <option value="長野県">長野県</option>
                          <option value="岐阜県">岐阜県</option>
                          <option value="静岡県">静岡県</option>
                          <option value="愛知県">愛知県</option>
                          <option value="三重県">三重県</option>
                          <option value="滋賀県">滋賀県</option>
                          <option value="京都府">京都府</option>
                          <option value="大阪府">大阪府</option>
                          <option value="兵庫県">兵庫県</option>
                          <option value="奈良県">奈良県</option>
                          <option value="和歌山県">和歌山県</option>
                          <option value="鳥取県">鳥取県</option>
                          <option value="島根県">島根県</option>
                          <option value="岡山県">岡山県</option>
                          <option value="広島県">広島県</option>
                          <option value="山口県">山口県</option>
                          <option value="徳島県">徳島県</option>
                          <option value="香川県">香川県</option>
                          <option value="愛媛県">愛媛県</option>
                          <option value="高知県">高知県</option>
                          <option value="福岡県">福岡県</option>
                          <option value="佐賀県">佐賀県</option>
                          <option value="長崎県">長崎県</option>
                          <option value="熊本県">熊本県</option>
                          <option value="大分県">大分県</option>
                          <option value="宮崎県">宮崎県</option>
                          <option value="鹿児島県">鹿児島県</option>
                          <option value="沖縄県">沖縄県</option>
                        </optgroup>
                        <optgroup label="離島">
                          <option value="屋久島">屋久島</option>
                          <option value="種子島">種子島</option>
                          <option value="奄美大島">奄美大島</option>
                          <option value="宮古島">宮古島</option>
                          <option value="石垣島">石垣島</option>
                          <option value="竹富島">竹富島</option>
                          <option value="西表島">西表島</option>
                          <option value="与那国島">与那国島</option>
                          <option value="佐渡島">佐渡島</option>
                          <option value="隠岐諸島">隠岐諸島</option>
                          <option value="壱岐">壱岐</option>
                          <option value="対馬">対馬</option>
                          <option value="五島列島">五島列島</option>
                          <option value="小笠原諸島">小笠原諸島</option>
                        </optgroup>
                      </select>
                    </div>
                    <div class="col-md-4">
                      <label for="language-filter" class="form-label">言語</label>
                      <select class="form-select" id="language-filter">
                        <option value="">すべて</option>
                        <option value="日本語">日本語</option>
                        <option value="英語">英語</option>
                        <option value="中国語">中国語</option>
                        <option value="韓国語">韓国語</option>
                        <option value="フランス語">フランス語</option>
                      </select>
                    </div>
                    <div class="col-md-4">
                      <label for="fee-filter" class="form-label">料金</label>
                      <select class="form-select" id="fee-filter">
                        <option value="">すべて</option>
                        <option value="6000">¥6,000~/回</option>
                        <option value="10000">¥10,000以下/回</option>
                        <option value="15000">¥15,000以下/回</option>
                        <option value="20000">¥20,000以下/回</option>
                      </select>
                    </div>
                    <div class="col-12">
                      <label class="form-label">キーワード</label>
                      <div class="d-flex flex-wrap" id="keyword-filter-group">
                        <div class="form-check me-3 mb-2">
                          <input class="form-check-input keyword-checkbox" type="checkbox" value="ナイトツアー" id="keyword-night">
                          <label class="form-check-label" for="keyword-night">ナイトツアー</label>
                        </div>
                        <div class="form-check me-3 mb-2">
                          <input class="form-check-input keyword-checkbox" type="checkbox" value="グルメ" id="keyword-food">
                          <label class="form-check-label" for="keyword-food">グルメ</label>
                        </div>
                        <div class="form-check me-3 mb-2">
                          <input class="form-check-input keyword-checkbox" type="checkbox" value="写真スポット" id="keyword-photo">
                          <label class="form-check-label" for="keyword-photo">写真スポット</label>
                        </div>
                        <div class="form-check me-3 mb-2">
                          <input class="form-check-input keyword-checkbox" type="checkbox" value="料理" id="keyword-cooking">
                          <label class="form-check-label" for="keyword-cooking">料理</label>
                        </div>
                        <div class="form-check me-3 mb-2">
                          <input class="form-check-input keyword-checkbox" type="checkbox" value="アクティビティ" id="keyword-activity">
                          <label class="form-check-label" for="keyword-activity">アクティビティ</label>
                        </div>
                      </div>
                      <input type="text" class="form-control mt-2" id="keyword-filter-custom" placeholder="その他のキーワードを入力（コンマ区切りで複数入力可）">
                      <small class="text-muted mt-1 d-block">
                        <i class="bi bi-info-circle"></i> 上記のチェックボックスまたはこの入力欄でキーワードを指定できます。複数のキーワードを入力する場合は、カンマ（,）で区切ってください。例: 「温泉,登山,ハイキング」
                      </small>
                    </div>
                    <div class="col-12 d-flex justify-content-end">
                      <button type="reset" class="btn btn-secondary me-2" id="reset-filters">リセット</button>
                      <button type="button" class="btn btn-primary" id="apply-filters">
                        <i class="bi bi-search"></i> 検索
                      </button>
                    </div>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="row guides-container" id="guide-cards-container">
        <!-- 初期表示されるガイド -->
        <!-- ガイド1 -->
        <div class="col-md-4 guide-item">
          <div class="card guide-card shadow-sm" data-guide-id="1" data-location="東京都 渋谷区" data-languages="日本語,英語" data-fee="6000" data-keywords="グルメ,写真スポット">
            <img src="attached_assets/IMG20221024140826_1750355257888.jpg" class="card-img-top guide-image" alt="ガイド写真">
            <div class="card-body">
              <div class="d-flex justify-content-between align-items-start mb-2">
                <h5 class="card-title mb-0">桃太郎</h5>
                <span class="badge bg-primary">¥6,000/セッション</span>
              </div>
              <p class="card-text text-muted mb-2 guide-location">
                <i class="bi bi-geo-alt-fill me-1"></i>東京都 渋谷区
              </p>
              <p class="card-text mb-3">東京の隠れた名所を案内します。グルメや写真スポットが得意です。</p>
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <span class="badge bg-light text-dark guide-lang me-1">日本語</span>
                  <span class="badge bg-light text-dark">英語</span>
                </div>
                <div class="text-warning">
                  <i class="bi bi-star-fill"></i>
                  <i class="bi bi-star-fill"></i>
                  <i class="bi bi-star-fill"></i>
                  <i class="bi bi-star-fill"></i>
                  <i class="bi bi-star-half"></i>
                  <span class="text-dark ms-1">4.5</span>
                </div>
              </div>
            </div>
            <div class="card-footer bg-white border-0 pt-0">
              <a href="#" class="btn btn-outline-primary w-100 guide-details-link" data-guide-id="1">詳細を見る</a>
            </div>
          </div>
        </div>
        
        <!-- ガイド2 -->
        <div class="col-md-4 guide-item">
          <div class="card guide-card shadow-sm" data-guide-id="2" data-location="京都府 京都市" data-languages="日本語,英語,中国語" data-fee="8000" data-keywords="歴史,文化,寺院,写真スポット">
            <img src="attached_assets/IMG20221024140826_1750355257888.jpg" class="card-img-top guide-image" alt="ガイド写真">
            <div class="card-body">
              <div class="d-flex justify-content-between align-items-start mb-2">
                <h5 class="card-title mb-0">花子</h5>
                <span class="badge bg-primary">¥5,500/セッション</span>
              </div>
              <p class="card-text text-muted mb-2 guide-location">
                <i class="bi bi-geo-alt-fill me-1"></i>京都府 京都市
              </p>
              <p class="card-text mb-3">歴史と伝統が息づく京都の魅力をご案内。寺社巡りや伝統文化体験が得意です。</p>
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <span class="badge bg-light text-dark guide-lang me-1">日本語</span>
                  <span class="badge bg-light text-dark">英語</span>
                </div>
                <div class="text-warning">
                  <i class="bi bi-star-fill"></i>
                  <i class="bi bi-star-fill"></i>
                  <i class="bi bi-star-fill"></i>
                  <i class="bi bi-star-fill"></i>
                  <i class="bi bi-star"></i>
                  <span class="text-dark ms-1">4.0</span>
                </div>
              </div>
            </div>
            <div class="card-footer bg-white border-0 pt-0">
              <a href="#" class="btn btn-outline-primary w-100 guide-details-link" data-guide-id="2">詳細を見る</a>
            </div>
          </div>
        </div>
        
        <!-- ガイド3 -->
        <div class="col-md-4 guide-item">
          <div class="card guide-card shadow-sm" data-guide-id="3" data-location="大阪府 大阪市" data-languages="日本語,英語" data-fee="7000" data-keywords="グルメ,ナイトツアー,ローカル">
            <img src="attached_assets/IMG20221024140826_1750355257888.jpg" class="card-img-top guide-image" alt="ガイド写真">
            <div class="card-body">
              <div class="d-flex justify-content-between align-items-start mb-2">
                <h5 class="card-title mb-0">一郎</h5>
                <span class="badge bg-primary">¥5,000/セッション</span>
              </div>
              <p class="card-text text-muted mb-2 guide-location">
                <i class="bi bi-geo-alt-fill me-1"></i>大阪府 大阪市
              </p>
              <p class="card-text mb-3">大阪ならではの食べ歩きと街歩きが専門。地元の人だけが知る名店にご案内します。</p>
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <span class="badge bg-light text-dark guide-lang me-1">日本語</span>
                  <span class="badge bg-light text-dark">英語(基礎)</span>
                </div>
                <div class="text-warning">
                  <i class="bi bi-star-fill"></i>
                  <i class="bi bi-star-fill"></i>
                  <i class="bi bi-star-fill"></i>
                  <i class="bi bi-star-half"></i>
                  <i class="bi bi-star"></i>
                  <span class="text-dark ms-1">3.5</span>
                </div>
              </div>
            </div>
            <div class="card-footer bg-white border-0 pt-0">
              <a href="#" class="btn btn-outline-primary w-100 guide-details-link" data-guide-id="3">詳細を見る</a>
            </div>
          </div>
        </div>
        
        <!-- 追加のガイド（初期状態では非表示） -->
        <!-- ガイド4 -->
        <div class="col-md-4 guide-item hidden-guide">
          <div class="card guide-card shadow-sm" data-guide-id="4">
            <img src="https://placehold.co/400x300?text=北海道ガイド" class="card-img-top guide-image" alt="ガイド写真">
            <div class="card-body">
              <div class="d-flex justify-content-between align-items-start mb-2">
                <h5 class="card-title mb-0">雪</h5>
                <span class="badge bg-primary">¥8,000/セッション</span>
              </div>
              <p class="card-text text-muted mb-2">
                <i class="bi bi-geo-alt-fill me-1"></i>北海道 札幌市
              </p>
              <p class="card-text mb-3">北海道・札幌のローカルガイド。四季折々の自然と新鮮な海の幸、絶景スポットをご案内します。</p>
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <span class="badge bg-light text-dark me-1">日本語</span>
                  <span class="badge bg-light text-dark me-1">英語</span>
                  <span class="badge bg-light text-dark">ロシア語</span>
                </div>
                <div class="text-warning">
                  <i class="bi bi-star-fill"></i>
                  <i class="bi bi-star-fill"></i>
                  <i class="bi bi-star-fill"></i>
                  <i class="bi bi-star-fill"></i>
                  <i class="bi bi-star"></i>
                  <span class="text-dark ms-1">4.0</span>
                </div>
              </div>
            </div>
            <div class="card-footer bg-white border-0 pt-0">
              <a href="#" class="btn btn-outline-primary w-100 guide-details-link" data-guide-id="4">詳細を見る</a>
            </div>
          </div>
        </div>
        
        <!-- ガイド5 -->
        <div class="col-md-4 guide-item hidden-guide">
          <div class="card guide-card shadow-sm" data-guide-id="5">
            <img src="https://placehold.co/400x300?text=沖縄ガイド" class="card-img-top guide-image" alt="ガイド写真">
            <div class="card-body">
              <div class="d-flex justify-content-between align-items-start mb-2">
                <h5 class="card-title mb-0">海</h5>
                <span class="badge bg-primary">¥12,000/セッション</span>
              </div>
              <p class="card-text text-muted mb-2">
                <i class="bi bi-geo-alt-fill me-1"></i>沖縄県 那覇市
              </p>
              <p class="card-text mb-3">沖縄在住15年のダイビングインストラクター。美しい海と独自の文化が残る島々を案内します。</p>
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <span class="badge bg-light text-dark me-1">日本語</span>
                  <span class="badge bg-light text-dark">英語</span>
                </div>
                <div class="text-warning">
                  <i class="bi bi-star-fill"></i>
                  <i class="bi bi-star-fill"></i>
                  <i class="bi bi-star-fill"></i>
                  <i class="bi bi-star-fill"></i>
                  <i class="bi bi-star-half"></i>
                  <span class="text-dark ms-1">4.5</span>
                </div>
              </div>
            </div>
            <div class="card-footer bg-white border-0 pt-0">
              <a href="#" class="btn btn-outline-primary w-100 guide-details-link" data-guide-id="5">詳細を見る</a>
            </div>
          </div>
        </div>
        
        <!-- ガイド6 -->
        <div class="col-md-4 guide-item hidden-guide">
          <div class="card guide-card shadow-sm" data-guide-id="6">
            <img src="https://placehold.co/400x300?text=広島ガイド" class="card-img-top guide-image" alt="ガイド写真">
            <div class="card-body">
              <div class="d-flex justify-content-between align-items-start mb-2">
                <h5 class="card-title mb-0">平和</h5>
                <span class="badge bg-primary">¥6,500/セッション</span>
              </div>
              <p class="card-text text-muted mb-2">
                <i class="bi bi-geo-alt-fill me-1"></i>広島県 広島市
              </p>
              <p class="card-text mb-3">広島の歴史と文化に精通したガイド。平和記念公園から宮島まで、心に残る旅をご提供します。</p>
              <div class="d-flex justify-content-between align-items-center">
                <div>
                  <span class="badge bg-light text-dark me-1">日本語</span>
                  <span class="badge bg-light text-dark me-1">英語</span>
                  <span class="badge bg-light text-dark">フランス語</span>
                </div>
                <div class="text-warning">
                  <i class="bi bi-star-fill"></i>
                  <i class="bi bi-star-fill"></i>
                  <i class="bi bi-star-fill"></i>
                  <i class="bi bi-star-fill"></i>
                  <i class="bi bi-star"></i>
                  <span class="text-dark ms-1">4.0</span>
                </div>
              </div>
            </div>
            <div class="card-footer bg-white border-0 pt-0">
              <a href="#" class="btn btn-outline-primary w-100 guide-details-link" data-guide-id="6">詳細を見る</a>
            </div>
          </div>
        </div>
      </div>
      
      <div class="text-center mt-4">
        <button class="btn btn-primary" id="load-more-guides">もっと見る</button>
      </div>
    </section>
    
    <!-- 使い方 -->
    <section id="how-it-works" class="mb-5">
      <h2 class="text-center mb-4">使い方</h2>
      <div class="row text-center">
        <div class="col-md-4 mb-3">
          <div class="p-3">
            <div class="bg-primary text-white rounded-circle d-inline-flex justify-content-center align-items-center mb-3" style="width: 80px; height: 80px;">
              <h3 class="m-0">1</h3>
            </div>
            <h4>アカウント登録</h4>
            <p>簡単な情報入力と電話番号認証で登録完了</p>
          </div>
        </div>
        <div class="col-md-4 mb-3">
          <div class="p-3">
            <div class="bg-primary text-white rounded-circle d-inline-flex justify-content-center align-items-center mb-3" style="width: 80px; height: 80px;">
              <h3 class="m-0">2</h3>
            </div>
            <h4>ガイドを探す</h4>
            <p>場所、言語、専門性などで理想のガイドを検索</p>
          </div>
        </div>
        <div class="col-md-4 mb-3">
          <div class="p-3">
            <div class="bg-primary text-white rounded-circle d-inline-flex justify-content-center align-items-center mb-3" style="width: 80px; height: 80px;">
              <h3 class="m-0">3</h3>
            </div>
            <h4>予約して楽しむ</h4>
            <p>希望の日時で予約し、特別な体験を楽しむ</p>
          </div>
        </div>
      </div>
    </section>
    
    <!-- ガイドのメリット -->
    <section id="guide-benefits" class="mb-5 py-5 bg-light">
      <div class="container">
        <h2 class="text-center mb-4">ガイドとして活躍するメリット</h2>
        <p class="text-center lead mb-5">あなたの知識と経験を活かして、世界中の旅行者に特別な体験を提供しましょう</p>
        
        <div class="row">
          <div class="col-lg-6">
            <div class="guide-benefit-card mb-4 p-4 bg-white rounded shadow-sm">
              <div class="d-flex">
                <div class="benefit-check me-3 text-primary">
                  <i class="bi bi-check-circle-fill fs-3"></i>
                </div>
                <div>
                  <h5>あなたの日常が観光資源になる</h5>
                  <p class="text-muted mb-0">地元の方だけが知る特別な場所や体験を共有することで、日常がかけがえのない旅の思い出に変わります。</p>
                </div>
              </div>
            </div>
          </div>
          
          <div class="col-lg-6">
            <div class="guide-benefit-card mb-4 p-4 bg-white rounded shadow-sm">
              <div class="d-flex">
                <div class="benefit-check me-3 text-primary">
                  <i class="bi bi-check-circle-fill fs-3"></i>
                </div>
                <div>
                  <h5>観光客の方を友達としてお迎えするだけです</h5>
                  <p class="text-muted mb-0">形式ばったガイドツアーではなく、友人との交流のように自然な形で地元の魅力を伝えられます。</p>
                </div>
              </div>
            </div>
          </div>
          
          <div class="col-lg-6">
            <div class="guide-benefit-card mb-4 p-4 bg-white rounded shadow-sm">
              <div class="d-flex">
                <div class="benefit-check me-3 text-primary">
                  <i class="bi bi-check-circle-fill fs-3"></i>
                </div>
                <div>
                  <h5>隙間時間を使って効率よくお仕事をする</h5>
                  <p class="text-muted mb-0">自分の都合の良い時間にスケジュールを設定できるため、本業や学業と両立しながら収入を得られます。</p>
                </div>
              </div>
            </div>
          </div>
          
          <div class="col-lg-6">
            <div class="guide-benefit-card mb-4 p-4 bg-white rounded shadow-sm">
              <div class="d-flex">
                <div class="benefit-check me-3 text-primary">
                  <i class="bi bi-check-circle-fill fs-3"></i>
                </div>
                <div>
                  <h5>自分の好きなことを仕事にできる</h5>
                  <p class="text-muted mb-0">趣味や特技、専門知識を活かしたオリジナルのガイド体験を提供することで、情熱を収入に変えられます。</p>
                </div>
              </div>
            </div>
          </div>
          
          <div class="col-lg-6">
            <div class="guide-benefit-card mb-4 p-4 bg-white rounded shadow-sm">
              <div class="d-flex">
                <div class="benefit-check me-3 text-primary">
                  <i class="bi bi-check-circle-fill fs-3"></i>
                </div>
                <div>
                  <h5>世界中の人と新しい出会いが生まれる</h5>
                  <p class="text-muted mb-0">様々な国や文化から来た旅行者との交流を通じて、国際的な人脈を広げ、異文化理解を深められます。</p>
                </div>
              </div>
            </div>
          </div>
          
          <div class="col-lg-6">
            <div class="guide-benefit-card mb-4 p-4 bg-white rounded shadow-sm">
              <div class="d-flex">
                <div class="benefit-check me-3 text-primary">
                  <i class="bi bi-check-circle-fill fs-3"></i>
                </div>
                <div>
                  <h5>語学力を活かし、さらに向上させられる</h5>
                  <p class="text-muted mb-0">外国語を使う実践的な機会が得られ、コミュニケーション能力が自然と高まります。</p>
                </div>
              </div>
            </div>
          </div>
          
          <div class="col-lg-6">
            <div class="guide-benefit-card mb-4 p-4 bg-white rounded shadow-sm">
              <div class="d-flex">
                <div class="benefit-check me-3 text-primary">
                  <i class="bi bi-check-circle-fill fs-3"></i>
                </div>
                <div>
                  <h5>地元への愛着と誇りが深まる</h5>
                  <p class="text-muted mb-0">地元の魅力を発信することで、自分自身の住む地域への理解や愛着がさらに強くなります。</p>
                </div>
              </div>
            </div>
          </div>
          
          <div class="col-lg-6">
            <div class="guide-benefit-card mb-4 p-4 bg-white rounded shadow-sm">
              <div class="d-flex">
                <div class="benefit-check me-3 text-primary">
                  <i class="bi bi-check-circle-fill fs-3"></i>
                </div>
                <div>
                  <h5>安心のサポート体制</h5>
                  <p class="text-muted mb-0">予約管理、決済、保険など、ガイド活動に必要な基盤を当サービスが提供するので安心して活動できます。</p>
                </div>
              </div>
            </div>
          </div>
          
          <div class="col-lg-6">
            <div class="guide-benefit-card mb-4 p-4 bg-white rounded shadow-sm">
              <div class="d-flex">
                <div class="benefit-check me-3 text-primary">
                  <i class="bi bi-check-circle-fill fs-3"></i>
                </div>
                <div>
                  <h5>自分のペースで活動可能</h5>
                  <p class="text-muted mb-0">予約を受ける日時や頻度は完全に自分で決められるため、ライフスタイルに合わせた働き方ができます。</p>
                </div>
              </div>
            </div>
          </div>
          
          <div class="col-lg-6">
            <div class="guide-benefit-card mb-4 p-4 bg-white rounded shadow-sm">
              <div class="d-flex">
                <div class="benefit-check me-3 text-primary">
                  <i class="bi bi-check-circle-fill fs-3"></i>
                </div>
                <div>
                  <h5>地域活性化に貢献できる</h5>
                  <p class="text-muted mb-0">観光客を地元のお店や施設に案内することで、地域経済の活性化とコミュニティの発展に貢献できます。</p>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="text-center mt-4">
          <button class="btn btn-primary btn-lg" data-bs-toggle="modal" data-bs-target="#registerGuideModal">ガイドとして登録する</button>
        </div>
      </div>
    </section>
  </div>

  <!-- 観光客登録モーダル -->
  <div class="modal fade" id="registerTouristModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">旅行者として登録</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="tourist-register-form">
            <!-- 基本情報セクション -->
            <div class="border-bottom pb-3 mb-3">
              <h4 class="section-title">基本情報</h4>
              <div class="mb-3">
                <label for="tourist-name" class="form-label">氏名 <span class="text-danger">*</span></label>
                <input type="text" class="form-control" id="tourist-name" required>
              </div>
              <div class="mb-3">
                <label for="tourist-email" class="form-label">メールアドレス <span class="text-danger">*</span></label>
                <input type="email" class="form-control" id="tourist-email" required>
              </div>
              <div class="mb-3">
                <label for="tourist-password" class="form-label">パスワード <span class="text-danger">*</span></label>
                <input type="password" class="form-control" id="tourist-password" required>
                <div class="form-text">8文字以上で、英数字を含めてください</div>
              </div>
            </div>
            
            <!-- 電話番号認証セクション -->
            <div class="border-bottom pb-3 mb-3">
              <h4 class="section-title">電話番号認証</h4>
              <div class="mb-3">
                <label for="tourist-phone-number" class="form-label">電話番号 <span class="text-danger">*</span></label>
                <div class="input-group">
                  <span class="input-group-text">+81</span>
                  <input type="tel" class="form-control" id="tourist-phone-number" placeholder="9012345678（先頭の0は除く）" required>
                  <button type="button" class="btn btn-primary" id="tourist-send-code-btn">認証コード送信</button>
                </div>
                <div class="form-text">ハイフンなしで入力してください</div>
              </div>
              
              <div class="mb-4" id="tourist-verification-code-container">
                <label for="tourist-verification-code" class="form-label">認証コード <span class="text-danger">*</span></label>
                <input type="text" class="form-control" id="tourist-verification-code" maxlength="6" placeholder="SMSに送信された6桁のコード">
              </div>
              
              <div id="tourist-recaptcha-container" class="mb-3"></div>
              <div id="tourist-phone-verified" class="alert alert-success d-none">電話番号認証が完了しました ✓</div>
            </div>
            
            <!-- 身分証明書セクション -->
            <div class="border-bottom pb-3 mb-3">
              <h4 class="section-title">身分証明書の確認</h4>
              <div class="mb-3">
                <label for="tourist-id-type" class="form-label">身分証明書の種類 <span class="text-danger">*</span></label>
                <select class="form-select" id="tourist-id-type" required>
                  <option value="" selected disabled>選択してください</option>
                  <option value="passport">パスポート</option>
                  <option value="drivers_license">運転免許証</option>
                  <option value="my_number">マイナンバーカード</option>
                </select>
              </div>
              
              <div class="mb-3">
                <label for="tourist-id-front" class="form-label">身分証明書（表面） <span class="text-danger">*</span></label>
                <div class="input-group">
                  <input type="file" class="form-control" id="tourist-id-front" accept="image/*" required>
                  <button type="button" class="btn btn-outline-secondary document-camera mobile-only" data-target="tourist-id-front">
                    <i class="bi bi-camera"></i> カメラ
                  </button>
                </div>
                <div class="form-text">JPG、PNG形式のみ、5MB以下</div>
                <div class="mt-2 document-preview-container" id="tourist-id-front-preview-container">
                  <div class="document-preview">
                    <img id="tourist-id-front-preview" class="img-fluid img-thumbnail d-none" alt="身分証明書表面のプレビュー">
                    <button type="button" class="btn btn-danger btn-sm mt-2 d-none" id="tourist-id-front-delete">
                      <i class="bi bi-trash"></i> 削除
                    </button>
                  </div>
                </div>
              </div>
              
              <div class="mb-3 d-none" id="tourist-id-back-container">
                <label for="tourist-id-back" class="form-label">身分証明書（裏面） <span class="text-danger">*</span></label>
                <div class="input-group">
                  <input type="file" class="form-control" id="tourist-id-back" accept="image/*">
                  <button type="button" class="btn btn-outline-secondary document-camera mobile-only" data-target="tourist-id-back">
                    <i class="bi bi-camera"></i> カメラ
                  </button>
                </div>
                <div class="form-text">JPG、PNG形式のみ、5MB以下</div>
                <div class="mt-2 document-preview-container" id="tourist-id-back-preview-container">
                  <div class="document-preview">
                    <img id="tourist-id-back-preview" class="img-fluid img-thumbnail d-none" alt="身分証明書裏面のプレビュー">
                    <button type="button" class="btn btn-danger btn-sm mt-2 d-none" id="tourist-id-back-delete">
                      <i class="bi bi-trash"></i> 削除
                    </button>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- 利用規約 -->
            <div class="mb-3">
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="tourist-terms" required>
                <label class="form-check-label" for="tourist-terms">
                  <a href="#" target="_blank">利用規約</a>と<a href="#" target="_blank">プライバシーポリシー</a>に同意します
                </label>
              </div>
            </div>
            
            <div class="d-grid">
              <button type="submit" class="btn btn-primary btn-lg">登録する</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- お問い合わせモーダル -->
  <div class="modal fade" id="contactModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">お問い合わせ</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="contact-form">
            <div class="mb-3">
              <label for="contact-name" class="form-label">お名前 <span class="text-danger">*</span></label>
              <input type="text" class="form-control" id="contact-name" required>
            </div>
            
            <div class="mb-3">
              <label for="contact-email" class="form-label">メールアドレス <span class="text-danger">*</span></label>
              <input type="email" class="form-control" id="contact-email" required>
            </div>
            
            <div class="mb-3">
              <label for="contact-subject" class="form-label">件名 <span class="text-danger">*</span></label>
              <select class="form-select" id="contact-subject" required>
                <option value="" selected disabled>選択してください</option>
                <option value="general">一般的なお問い合わせ</option>
                <option value="service">サービスについて</option>
                <option value="support">サポートが必要</option>
                <option value="feedback">フィードバック・提案</option>
                <option value="other">その他</option>
              </select>
            </div>
            
            <div class="mb-3">
              <label for="contact-message" class="form-label">メッセージ <span class="text-danger">*</span></label>
              <textarea class="form-control" id="contact-message" rows="5" required></textarea>
            </div>
            
            <div class="d-grid">
              <button type="submit" class="btn btn-primary">送信する</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
  
  <!-- 観光客ログインモーダル -->
  <div class="modal fade" id="loginTouristModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">旅行者ログイン</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="tourist-login-form">
            <div class="mb-3">
              <label for="tourist-login-email" class="form-label">メールアドレス</label>
              <input type="email" class="form-control" id="tourist-login-email" required>
            </div>
            <div class="mb-3">
              <label for="tourist-login-password" class="form-label">パスワード</label>
              <input type="password" class="form-control" id="tourist-login-password" required>
            </div>
            <div class="d-grid mb-3">
              <button type="submit" class="btn btn-primary">ログイン</button>
            </div>
            <div class="text-center">
              <p class="mb-0">アカウントをお持ちでない方は <a href="#" data-bs-dismiss="modal" data-bs-toggle="modal" data-bs-target="#registerTouristModal">こちら</a> から登録できます</p>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- 登録促進モーダル -->
  <div class="modal fade" id="registerPromptModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">会員登録が必要です</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="text-center mb-4">
            <i class="bi bi-lock-fill text-primary" style="font-size: 3rem;"></i>
            <h4 class="mt-3">ガイドの詳細情報を見るには会員登録が必要です</h4>
            <p class="text-muted">登録はとても簡単で、多くの特典が得られます。</p>
          </div>
          
          <div class="row mb-4">
            <div class="col-md-6">
              <div class="card h-100">
                <div class="card-body">
                  <h5 class="card-title"><i class="bi bi-person me-2"></i>旅行者として登録</h5>
                  <p class="card-text">現地ガイドと一緒に特別な旅行体験を探しましょう。</p>
                  <button class="btn btn-primary w-100" data-bs-dismiss="modal" data-bs-toggle="modal" data-bs-target="#registerTouristModal">
                    旅行者登録へ進む
                  </button>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="card h-100">
                <div class="card-body">
                  <h5 class="card-title"><i class="bi bi-map me-2"></i>ガイドとして登録</h5>
                  <p class="card-text">あなたの知識と経験を共有し、収入を得ましょう。</p>
                  <button class="btn btn-outline-primary w-100" data-bs-dismiss="modal" data-bs-toggle="modal" data-bs-target="#registerGuideModal">
                    ガイド登録へ進む
                  </button>
                </div>
              </div>
            </div>
          </div>
          
          <div class="text-center">
            <p>すでにアカウントをお持ちの方は<a href="#" data-bs-dismiss="modal" data-bs-toggle="modal" data-bs-target="#loginModal">こちらからログイン</a>してください。</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ガイド登録モーダル -->
  <div class="modal fade" id="registerGuideModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">ガイドとして登録</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="guide-register-form">
            <!-- 基本情報セクション -->
            <div class="border-bottom pb-3 mb-3">
              <h4 class="section-title">基本情報</h4>
              
              <!-- プロフィール写真 -->
              <div class="mb-4 text-center">
                <label for="guide-profile-photo" class="form-label d-block">プロフィール写真 <span class="text-danger">*</span></label>
                <div class="profile-photo-container mx-auto mb-3">
                  <img id="guide-profile-preview" src="https://placehold.co/150?text=写真" class="img-thumbnail rounded-circle profile-photo" alt="プロフィール写真">
                  <div class="profile-photo-overlay">
                    <i class="bi bi-camera-fill"></i>
                  </div>
                </div>
                <div class="d-flex justify-content-center">
                  <div class="w-50">
                    <input type="file" class="form-control" id="guide-profile-photo" accept="image/*" required>
                    <button type="button" class="btn btn-outline-secondary document-camera mobile-only mt-2 w-100" data-target="guide-profile-photo">
                      <i class="bi bi-camera"></i> カメラで撮影
                    </button>
                  </div>
                </div>
                <div class="form-text">JPG、PNG形式のみ、5MB以下</div>
              </div>
              
              <div class="row mb-3">
                <div class="col-md-6">
                  <label for="guide-name" class="form-label">氏名 <span class="text-danger">*</span></label>
                  <input type="text" class="form-control" id="guide-name" required>
                </div>
                <div class="col-md-6">
                  <label for="guide-username" class="form-label">ユーザー名 <span class="text-danger">*</span></label>
                  <input type="text" class="form-control" id="guide-username" required>
                  <div class="form-text">プロフィールURLに使用されます</div>
                </div>
              </div>
              <div class="mb-3">
                <label for="guide-email" class="form-label">メールアドレス <span class="text-danger">*</span></label>
                <input type="email" class="form-control" id="guide-email" required>
              </div>
              <div class="mb-3">
                <label for="guide-password" class="form-label">パスワード <span class="text-danger">*</span></label>
                <input type="password" class="form-control" id="guide-password" required>
                <div class="form-text">8文字以上で、英数字を含めてください</div>
              </div>
              <div class="mb-3">
                <label for="guide-location" class="form-label">活動エリア <span class="text-danger">*</span></label>
                <input type="text" class="form-control" id="guide-location" placeholder="例：東京都新宿区" required>
              </div>
              <div class="mb-3">
                <label for="guide-languages" class="form-label">対応言語 <span class="text-danger">*</span></label>
                <select class="form-select" id="guide-languages" multiple required>
                  <option value="ja">日本語</option>
                  <option value="en">英語</option>
                  <option value="zh">中国語</option>
                  <option value="ko">韓国語</option>
                  <option value="fr">フランス語</option>
                  <option value="de">ドイツ語</option>
                  <option value="es">スペイン語</option>
                </select>
                <div class="form-text">Ctrlキーを押しながら複数選択できます</div>
              </div>
            </div>
            
            <!-- 電話番号認証セクション -->
            <div class="border-bottom pb-3 mb-3">
              <h4 class="section-title">電話番号認証</h4>
              <div class="mb-3">
                <label for="guide-phone-number" class="form-label">電話番号 <span class="text-danger">*</span></label>
                <div class="input-group">
                  <span class="input-group-text">+81</span>
                  <input type="tel" class="form-control" id="guide-phone-number" placeholder="9012345678（先頭の0は除く）" required>
                  <button type="button" class="btn btn-primary" id="guide-send-code-btn">認証コード送信</button>
                </div>
                <div class="form-text">ハイフンなしで入力してください</div>
              </div>
              
              <div class="mb-4" id="guide-verification-code-container">
                <label for="guide-verification-code" class="form-label">認証コード <span class="text-danger">*</span></label>
                <input type="text" class="form-control" id="guide-verification-code" maxlength="6" placeholder="SMSに送信された6桁のコード">
              </div>
              
              <div id="guide-recaptcha-container" class="mb-3"></div>
              <div id="guide-phone-verified" class="alert alert-success d-none">電話番号認証が完了しました ✓</div>
            </div>
            
            <!-- 身分証明書セクション -->
            <div class="border-bottom pb-3 mb-3">
              <h4 class="section-title">身分証明書の確認</h4>
              <div class="mb-3">
                <label for="guide-id-type" class="form-label">身分証明書の種類 <span class="text-danger">*</span></label>
                <select class="form-select" id="guide-id-type" required>
                  <option value="" selected disabled>選択してください</option>
                  <option value="passport">パスポート</option>
                  <option value="drivers_license">運転免許証</option>
                  <option value="my_number">マイナンバーカード</option>
                </select>
              </div>
              
              <div class="mb-3">
                <label for="guide-id-front" class="form-label">身分証明書（表面） <span class="text-danger">*</span></label>
                <div class="input-group">
                  <input type="file" class="form-control" id="guide-id-front" accept="image/*" required>
                  <button type="button" class="btn btn-outline-secondary document-camera mobile-only" data-target="guide-id-front">
                    <i class="bi bi-camera"></i> カメラ
                  </button>
                </div>
                <div class="form-text">JPG、PNG形式のみ、5MB以下</div>
                <div class="mt-2 document-preview-container" id="guide-id-front-preview-container">
                  <div class="document-preview">
                    <img id="guide-id-front-preview" class="img-fluid img-thumbnail d-none" alt="身分証明書表面のプレビュー">
                    <button type="button" class="btn btn-danger btn-sm mt-2 d-none" id="guide-id-front-delete">
                      <i class="bi bi-trash"></i> 削除
                    </button>
                  </div>
                </div>
              </div>
              
              <div class="mb-3 d-none" id="guide-id-back-container">
                <label for="guide-id-back" class="form-label">身分証明書（裏面） <span class="text-danger">*</span></label>
                <div class="input-group">
                  <input type="file" class="form-control" id="guide-id-back" accept="image/*">
                  <button type="button" class="btn btn-outline-secondary document-camera mobile-only" data-target="guide-id-back">
                    <i class="bi bi-camera"></i> カメラ
                  </button>
                </div>
                <div class="form-text">JPG、PNG形式のみ、5MB以下</div>
                <div class="mt-2 document-preview-container" id="guide-id-back-preview-container">
                  <div class="document-preview">
                    <img id="guide-id-back-preview" class="img-fluid img-thumbnail d-none" alt="身分証明書裏面のプレビュー">
                    <button type="button" class="btn btn-danger btn-sm mt-2 d-none" id="guide-id-back-delete">
                      <i class="bi bi-trash"></i> 削除
                    </button>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- 利用規約 -->
            <div class="mb-3">
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="guide-terms" required>
                <label class="form-check-label" for="guide-terms">
                  <a href="#" target="_blank">利用規約</a>、<a href="#" target="_blank">プライバシーポリシー</a>、および<a href="#" target="_blank">ガイドラインポリシー</a>に同意します
                </label>
              </div>
            </div>
            
            <div class="d-grid">
              <button type="submit" class="btn btn-primary btn-lg">登録する</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- ログインモーダル -->
  <div class="modal fade" id="loginModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header bg-primary text-white">
          <h5 class="modal-title">ログイン</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="login-form">
            <div class="mb-3">
              <label class="form-label">ユーザータイプ</label>
              <div class="user-type-selector">
                <div class="btn-group w-100" role="group" aria-label="ユーザータイプ選択">
                  <input type="radio" class="btn-check" name="login-user-type" id="login-user-tourist" value="tourist" autocomplete="off" checked>
                  <label class="btn btn-outline-primary" for="login-user-tourist">
                    <i class="bi bi-person me-1"></i> 観光客
                  </label>
                  
                  <input type="radio" class="btn-check" name="login-user-type" id="login-user-guide" value="guide" autocomplete="off">
                  <label class="btn btn-outline-primary" for="login-user-guide">
                    <i class="bi bi-map me-1"></i> ガイド
                  </label>
                </div>
              </div>
              <div class="user-type-helper text-center mt-1 mb-3">
                <small id="user-type-description" class="text-muted">
                  観光客としてログインすると、ガイドを探したり予約できます
                </small>
              </div>
            </div>
            <div class="mb-3">
              <label for="login-email" class="form-label">メールアドレス</label>
              <div class="input-group">
                <span class="input-group-text bg-white border-end-0">
                  <i class="bi bi-envelope text-muted"></i>
                </span>
                <input type="email" class="form-control border-start-0" id="login-email" placeholder="example@email.com" required>
              </div>
            </div>
            <div class="mb-3">
              <label for="login-password" class="form-label">パスワード</label>
              <input type="password" class="form-control" id="login-password" placeholder="パスワードを入力" required>
              <div class="mt-2">
                <a href="#" class="password-reset-link">
                  <i class="bi bi-question-circle me-1"></i>パスワードをお忘れですか？
                </a>
              </div>
            </div>
            <div class="mb-3 form-check">
              <input type="checkbox" class="form-check-input" id="login-remember">
              <label class="form-check-label" for="login-remember">ログイン情報を保存する</label>
            </div>
            <div class="d-grid">
              <button type="submit" class="btn btn-primary login-button" id="main-login-btn">
                <i class="bi bi-box-arrow-in-right me-2"></i>ログイン
              </button>
            </div>
          </form>
          <hr>
          <div class="text-center">
            <div class="bg-light rounded p-3 mb-3">
              <h6 class="text-primary mb-2">デモアカウント（テスト用）</h6>
              <div class="small text-start">
                <div><strong>メール:</strong> test@example.com</div>
                <div><strong>パスワード:</strong> password</div>
                <hr class="my-2">
                <div><strong>メール:</strong> tourist@test.com</div>
                <div><strong>パスワード:</strong> test123</div>
              </div>
            </div>
            <p class="mb-2">アカウントをお持ちでない方</p>
            <button class="btn btn-outline-primary" data-bs-dismiss="modal" data-bs-toggle="modal" data-bs-target="#registerTouristModal">
              <i class="bi bi-person-plus me-1"></i>新規登録
            </button>
          </div>
          
          <!-- ソーシャルログイン（将来的な機能） -->
          <div class="social-login d-none">
            <div class="social-login-title">または</div>
            <div class="social-login-buttons">
              <button class="social-btn" title="Googleでログイン">
                <i class="bi bi-google"></i>
              </button>
              <button class="social-btn" title="Facebookでログイン">
                <i class="bi bi-facebook"></i>
              </button>
              <button class="social-btn" title="Twitterでログイン">
                <i class="bi bi-twitter"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- スクリプト -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
  
  <!-- ユーザータイプ選択の動作改善 -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // ガイド詳細ページからのリダイレクトでログインモーダルを表示
      if (sessionStorage.getItem('showLoginOnLoad') === 'true') {
        sessionStorage.removeItem('showLoginOnLoad');
        const accessMessage = sessionStorage.getItem('accessAttemptMessage');
        if (accessMessage) {
          sessionStorage.removeItem('accessAttemptMessage');
        }
        setTimeout(() => {
          const pendingGuideId = sessionStorage.getItem('pendingGuideId');
          if (pendingGuideId) {
            showTouristLoginPrompt(pendingGuideId);
          } else {
            // フォールバック：通常のログインモーダルを表示
            const loginModal = new bootstrap.Modal(document.getElementById('loginModal'));
            loginModal.show();
          }
        }, 800);
      }
      
      // URLパラメータで直接ガイド詳細アクセスを試みた場合の処理
      const urlParams = new URLSearchParams(window.location.search);
      const requireLogin = urlParams.get('requireLogin');
      const directGuideId = urlParams.get('guide');
      
      if (requireLogin === 'true') {
        // サーバーサイドからのリダイレクトでログインが必要な場合
        if (directGuideId) {
          sessionStorage.setItem('pendingGuideId', directGuideId);
        }
        setTimeout(() => {
          if (directGuideId) {
            showTouristLoginPrompt(directGuideId);
          } else {
            const loginModal = new bootstrap.Modal(document.getElementById('loginModal'));
            loginModal.show();
          }
        }, 1000);
        // URLからパラメータを削除
        window.history.replaceState({}, document.title, window.location.pathname);
      } else if (directGuideId && !localStorage.getItem('touristData')) {
        // 未ログインで直接ガイドページアクセスを試みた場合
        sessionStorage.setItem('pendingGuideId', directGuideId);
        setTimeout(() => {
          showTouristLoginPrompt(directGuideId);
        }, 1000);
        // URLからパラメータを削除
        window.history.replaceState({}, document.title, window.location.pathname);
      }
      
      // ログインモーダル内のユーザータイプ切り替え機能
      const touristRadio = document.getElementById('login-user-tourist');
      const guideRadio = document.getElementById('login-user-guide');
      const userTypeDescription = document.getElementById('user-type-description');
      
      function updateUserTypeDescription() {
        if (touristRadio && guideRadio && userTypeDescription) {
          if (touristRadio.checked) {
            userTypeDescription.textContent = '観光客としてログインすると、ガイドを探したり予約できます';
          } else if (guideRadio.checked) {
            userTypeDescription.textContent = 'ガイドとしてログインすると、プロフィールの編集や予約の管理ができます';
          }
          console.log('ユーザータイプが変更されました:', touristRadio.checked ? 'tourist' : 'guide');
        }
      }
      
      // 初期状態で説明テキストを設定
      updateUserTypeDescription();
      
      // ラジオボタンの変更を監視
      if (touristRadio) touristRadio.addEventListener('change', updateUserTypeDescription);
      if (guideRadio) guideRadio.addEventListener('change', updateUserTypeDescription);
    });
  </script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // 身分証明書タイプによる表示切替（ガイド）
      const guideIdTypeSelect = document.getElementById('guide-id-type');
      const guideIdBackContainer = document.getElementById('guide-id-back-container');
      
      if (guideIdTypeSelect && guideIdBackContainer) {
        guideIdTypeSelect.addEventListener('change', function() {
          if (this.value === 'drivers_license' || this.value === 'my_number') {
            guideIdBackContainer.classList.remove('d-none');
          } else {
            guideIdBackContainer.classList.add('d-none');
          }
        });
      }
      
      // 身分証明書タイプによる表示切替（旅行者）
      const touristIdTypeSelect = document.getElementById('tourist-id-type');
      const touristIdBackContainer = document.getElementById('tourist-id-back-container');
      
      if (touristIdTypeSelect && touristIdBackContainer) {
        touristIdTypeSelect.addEventListener('change', function() {
          if (this.value === 'drivers_license' || this.value === 'my_number') {
            touristIdBackContainer.classList.remove('d-none');
          } else {
            touristIdBackContainer.classList.add('d-none');
          }
        });
      }

      // 身分証明書プレビューと削除機能の設定
      setupDocumentPreview('guide-id-front');
      setupDocumentPreview('guide-id-back');
      setupDocumentPreview('tourist-id-front');
      setupDocumentPreview('tourist-id-back');
      
      function setupDocumentPreview(inputId) {
        const fileInput = document.getElementById(inputId);
        const previewImg = document.getElementById(`${inputId}-preview`);
        const deleteBtn = document.getElementById(`${inputId}-delete`);
        
        if (fileInput && previewImg && deleteBtn) {
          // ファイル選択時のプレビュー
          fileInput.addEventListener('change', function(e) {
            if (this.files && this.files[0]) {
              const reader = new FileReader();
              
              reader.onload = function(e) {
                previewImg.src = e.target.result;
                previewImg.classList.remove('d-none');
                deleteBtn.classList.remove('d-none');
              };
              
              reader.readAsDataURL(this.files[0]);
            }
          });
          
          // 削除ボタンのイベント
          deleteBtn.addEventListener('click', function() {
            fileInput.value = '';
            previewImg.src = '';
            previewImg.classList.add('d-none');
            deleteBtn.classList.add('d-none');
          });
        }
      }
      
      // デバイス検出とカメラボタンの表示/非表示
      function isMobile() {
        return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
      }
      
      // PCの場合はカメラボタンを非表示
      if (!isMobile()) {
        document.querySelectorAll('.mobile-only').forEach(elem => {
          elem.style.display = 'none';
        });
      }
      
      // 電話番号認証シミュレーション
      setupPhoneVerification('tourist');
      setupPhoneVerification('guide');
      
      function setupPhoneVerification(prefix) {
        const sendCodeBtn = document.getElementById(`${prefix}-send-code-btn`);
        const codeInput = document.getElementById(`${prefix}-verification-code`);
        const verifiedDiv = document.getElementById(`${prefix}-phone-verified`);
        const phoneInput = document.getElementById(`${prefix}-phone-number`);
        
        if (sendCodeBtn && codeInput && verifiedDiv && phoneInput) {
          sendCodeBtn.addEventListener('click', function() {
            const phone = phoneInput.value.trim();
            if (!phone) {
              alert('電話番号を入力してください');
              return;
            }
            
            // 送信中状態を表示
            const originalBtnText = sendCodeBtn.textContent;
            sendCodeBtn.disabled = true;
            sendCodeBtn.innerHTML = '<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> 送信中...';
            
            // 送信シミュレーション（1秒後）
            setTimeout(() => {
              sendCodeBtn.disabled = false;
              sendCodeBtn.textContent = originalBtnText;
              alert('テスト用認証コード: 123456');
              codeInput.value = '123456';
            }, 1000);
          });
          
          // 認証ボタンを追加
          const verifyContainer = document.createElement('div');
          verifyContainer.className = 'mt-3';
          const verifyButton = document.createElement('button');
          verifyButton.type = 'button';
          verifyButton.className = 'btn btn-success';
          verifyButton.textContent = '認証する';
          verifyButton.id = `${prefix}-verify-code-btn`;
          verifyContainer.appendChild(verifyButton);
          
          const codeContainer = document.getElementById(`${prefix}-verification-code-container`);
          if (codeContainer && !document.getElementById(`${prefix}-verify-code-btn`)) {
            codeContainer.appendChild(verifyContainer);
          }
          
          // 認証ボタンのイベントリスナー
          verifyButton.addEventListener('click', function() {
            const code = codeInput.value.trim();
            if (!code) {
              alert('認証コードを入力してください');
              return;
            }
            
            // 認証中状態を表示
            const originalBtnText = verifyButton.textContent;
            verifyButton.disabled = true;
            verifyButton.innerHTML = '<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> 認証中...';
            
            // 認証シミュレーション（1秒後）
            setTimeout(() => {
              if (code === '123456') {
                verifiedDiv.classList.remove('d-none');
                phoneInput.readOnly = true;
                sendCodeBtn.disabled = true;
                verifyButton.disabled = true;
                
                // 認証成功メッセージ
                alert('電話番号が認証されました');
                
                // 認証コード入力欄を非表示に
                setTimeout(() => {
                  if (codeContainer) {
                    codeContainer.style.display = 'none';
                  }
                }, 1500);
              } else {
                verifyButton.disabled = false;
                verifyButton.textContent = originalBtnText;
                alert('認証コードが正しくありません');
              }
            }, 1000);
          });
          
          // 入力時の自動検証（オプション）
          codeInput.addEventListener('input', function() {
            // 6桁の認証コードが入力されたら認証ボタンをハイライト
            if (this.value.length === 6) {
              verifyButton.classList.add('btn-pulse');
            } else {
              verifyButton.classList.remove('btn-pulse');
            }
          });
        }
      }
      
      // フォーム送信のシミュレーション
      const touristForm = document.getElementById('tourist-register-form');
      const guideForm = document.getElementById('guide-register-form');
      const loginForm = document.getElementById('login-form');
      
      if (touristForm) {
        touristForm.addEventListener('submit', function(e) {
          e.preventDefault();
          
          // 電話番号認証チェック（デモ用に簡略化）
          const phoneVerified = document.getElementById('tourist-phone-verified');
          if (phoneVerified.classList.contains('d-none')) {
            // デモ用：電話番号が入力されていれば自動認証
            const phoneNumber = document.getElementById('tourist-phone-number').value;
            if (phoneNumber && phoneNumber.length >= 10) {
              phoneVerified.classList.remove('d-none');
            } else {
              alert('電話番号を入力してください');
              return;
            }
          }
          
          // 身分証明書アップロードチェック（デモ用に簡略化）
          const touristIdType = document.getElementById('tourist-id-type').value;
          if (!touristIdType) {
            alert('身分証明書の種類を選択してください');
            return;
          }
          
          const touristIdFront = document.getElementById('tourist-id-front');
          if (!touristIdFront.files || touristIdFront.files.length === 0) {
            alert('身分証明書（表面）をアップロードしてください');
            return;
          }
          
          // 裏面が必要な場合は確認（運転免許証とマイナンバーカードのみ）
          const touristIdBack = document.getElementById('tourist-id-back');
          if ((touristIdType === 'drivers_license' || touristIdType === 'my_number') && 
              (!touristIdBack.files || touristIdBack.files.length === 0)) {
            alert('身分証明書（裏面）をアップロードしてください');
            return;
          }
          
          // 観光客データを作成・保存
          const touristData = {
            id: 'tourist_' + Date.now(),
            name: document.getElementById('tourist-name').value,
            email: document.getElementById('tourist-email').value,
            phone: document.getElementById('tourist-phone-number').value,
            idType: document.getElementById('tourist-id-type').value,
            registrationDate: new Date().toISOString(),
            isVerified: true
          };
          
          // ローカルストレージに保存
          localStorage.setItem('touristData', JSON.stringify(touristData));
          sessionStorage.setItem('currentUser', JSON.stringify(touristData));
          
          // 登録完了と機能アンロック通知を表示
          showTouristRegistrationSuccess(touristData);
          
          // モーダルを閉じる
          const modal = bootstrap.Modal.getInstance(document.getElementById('registerTouristModal'));
          modal.hide();
          
          // 保存されていたガイドIDを取得
          const pendingGuideId = sessionStorage.getItem('pendingGuideId');
          
          // ガイド詳細ページに自動リダイレクト
          setTimeout(() => {
            if (pendingGuideId) {
              sessionStorage.removeItem('pendingGuideId');
              window.location.href = `guide-details.html?id=${pendingGuideId}`;
            } else {
              // ガイドIDが見つからない場合はホームの人気ガイドセクションにスクロール
              document.getElementById('guides').scrollIntoView({ behavior: 'smooth' });
            }
          }, 500);
        });
      }
      
      if (guideForm) {
        guideForm.addEventListener('submit', function(e) {
          e.preventDefault();
          
          // 電話番号認証チェック
          if (document.getElementById('guide-phone-verified').classList.contains('d-none')) {
            alert('電話番号認証を完了してください');
            return;
          }
          
          // 身分証明書アップロードチェック
          const guideIdFront = document.getElementById('guide-id-front');
          if (!guideIdFront.files || guideIdFront.files.length === 0) {
            alert('身分証明書（表面）をアップロードしてください');
            return;
          }
          
          // 裏面が必要な場合は確認
          const guideIdType = document.getElementById('guide-id-type').value;
          const guideIdBack = document.getElementById('guide-id-back');
          if ((guideIdType === 'drivers_license' || guideIdType === 'my_number') && 
              (!guideIdBack.files || guideIdBack.files.length === 0)) {
            alert('身分証明書（裏面）をアップロードしてください');
            return;
          }
          
          // ガイド登録データの保存は専用スクリプト（guide_registration_handler.js）で行います
          
          // すべての検証に通過した場合
          alert('登録リクエストを受け付けました。身分証明書の確認後に承認されます。');
          const modal = bootstrap.Modal.getInstance(document.getElementById('registerGuideModal'));
          modal.hide();
        });
      }
      
      // ログインフォームの処理
      if (loginForm) {
        loginForm.addEventListener('submit', function(e) {
          e.preventDefault();
          
          const userType = document.querySelector('input[name="login-user-type"]:checked').value;
          const email = document.getElementById('login-email').value;
          const password = document.getElementById('login-password').value;
          
          if (!email || !password) {
            alert('メールアドレスとパスワードを入力してください');
            return;
          }
          
          // 観光客としてログイン
          if (userType === 'tourist') {
            handleTouristLogin(email, password);
          } else {
            // ガイドログインは別途実装
            alert('ガイドログイン機能は準備中です');
          }
        });
      }
      
      // ガイド詳細ボタンクリック処理
      window.handleGuideDetailsClick = function(guideId) {
        // 認証状態をチェック
        const touristData = localStorage.getItem('touristData');
        
        if (touristData) {
          // ログイン済みの場合は詳細ページに遷移
          window.location.replace(`guide-details.html?id=${guideId}`);
          return;
        }
        
        // 未ログインの場合は登録促進モーダルを表示
        sessionStorage.setItem('pendingGuideId', guideId);
        showTouristLoginPrompt(guideId);
      };

      // ガイド詳細閲覧にログインが必要であることを明示（旧関数、互換性のため）
      function showLoginRequirement(guideId) {
        handleGuideDetailsClick(guideId);
      }

      // 観光客ログイン促進モーダルを表示（無効化）
      function showTouristLoginPrompt(guideId) {
        // この機能は無効化されています - 新しい認証フローを使用
        console.log('showTouristLoginPrompt は無効化されています');
        return;
      }

      // 観光客ログイン促進モーダルを動的作成
      function createTouristLoginPromptModal() {
        const modalHTML = `
          <div class="modal fade" id="touristLoginPromptModal" tabindex="-1" aria-hidden="true">
            <div class="modal-dialog modal-lg">
              <div class="modal-content">
                <div class="modal-header bg-warning text-dark">
                  <h5 class="modal-title">
                    <i class="bi bi-shield-lock me-2"></i>ガイド詳細の閲覧にはログインが必要です
                  </h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body text-center">
                  <div class="mb-4">
                    <i class="bi bi-person-check-fill text-primary" style="font-size: 3rem;"></i>
                  </div>
                  <h4 class="mb-3">安全で信頼できるサービスのために</h4>
                  <p class="lead mb-4">
                    ガイドの詳細情報や予約機能をご利用いただくには、観光客としてのアカウント登録・ログインが必要です。
                  </p>
                  <div class="alert alert-info">
                    <strong>なぜログインが必要なのか？</strong><br>
                    • お客様とガイドの安全確保<br>
                    • 信頼性の高いマッチング<br>
                    • 予約履歴の管理<br>
                    • 品質向上のためのフィードバック
                  </div>
                  <p id="selectedGuideInfo" class="text-muted small"></p>
                </div>
                <div class="modal-footer justify-content-center">
                  <button type="button" class="btn btn-primary btn-lg me-3" onclick="showTouristRegistration()">
                    <i class="bi bi-person-plus me-1"></i>新規登録（推奨）
                  </button>
                  <button type="button" class="btn btn-outline-primary btn-lg" onclick="showExistingLogin()">
                    <i class="bi bi-box-arrow-in-right me-1"></i>既存アカウントでログイン
                  </button>
                </div>
              </div>
            </div>
          </div>
        `;
        document.body.insertAdjacentHTML('beforeend', modalHTML);
      }

      // 新規登録フォームを表示
      function showTouristRegistration() {
        // 促進モーダルを閉じる
        const promptModal = bootstrap.Modal.getInstance(document.getElementById('touristLoginPromptModal'));
        if (promptModal) {
          promptModal.hide();
        }
        
        // 観光客登録モーダルを表示
        setTimeout(() => {
          const registerModal = new bootstrap.Modal(document.getElementById('registerTouristModal'));
          registerModal.show();
        }, 300);
      }

      // 既存ログインフォームを表示
      function showExistingLogin() {
        // 促進モーダルを閉じる
        const promptModal = bootstrap.Modal.getInstance(document.getElementById('touristLoginPromptModal'));
        if (promptModal) {
          promptModal.hide();
        }
        
        // ログインモーダルを表示
        setTimeout(() => {
          const loginModal = new bootstrap.Modal(document.getElementById('loginModal'));
          // 観光客ラジオボタンを選択
          document.getElementById('login-user-tourist').checked = true;
          loginModal.show();
        }, 300);
      }

      // 観光客ログイン処理（統一認証システムに移管済み）
      function handleTouristLogin(email, password) {
        console.log('旧ログイン関数は無効化されています - 統一認証システムを使用');
        return;
      }
      
      // 観光客認証情報の検証（統一認証システムに移管済み）
      function isValidTouristCredentials(email, password) {
        console.log('旧認証関数は無効化されています - 統一認証システムを使用');
        return false;
      }
      
      // メールアドレスから名前を抽出
      function extractNameFromEmail(email) {
        const localPart = email.split('@')[0];
        return localPart.charAt(0).toUpperCase() + localPart.slice(1);
      }
      
      /**
       * 観光客登録成功時の包括的な通知システム
       * アンロックされた機能を詳細に説明
       */
      function showTouristRegistrationSuccess(userData) {
        // 既存のモーダルを閉じる
        const registerModal = bootstrap.Modal.getInstance(document.getElementById('registerTouristModal'));
        if (registerModal) {
          registerModal.hide();
        }
        
        // 成功通知モーダルのHTML
        const successModalHTML = `
          <div class="modal fade show" id="touristSuccessModal" tabindex="-1" style="display: block; background: rgba(0,0,0,0.5);">
            <div class="modal-dialog modal-lg modal-dialog-centered">
              <div class="modal-content border-0 shadow-lg" style="border-radius: 20px;">
                <div class="modal-header border-0 pb-0" style="background: linear-gradient(135deg, #28a745, #20c997); border-radius: 20px 20px 0 0;">
                  <div class="w-100 text-center text-white">
                    <div class="mb-3">
                      <i class="bi bi-check-circle-fill" style="font-size: 4rem;"></i>
                    </div>
                    <h3 class="modal-title fw-bold mb-2">登録完了おめでとうございます！</h3>
                    <p class="mb-0">${userData.name}様、TomoTripへようこそ</p>
                  </div>
                </div>
                <div class="modal-body px-4 py-4">
                  <div class="alert alert-success border-0 mb-4" style="background: linear-gradient(135deg, #d4edda, #c3e6cb);">
                    <div class="d-flex align-items-center">
                      <i class="bi bi-shield-check text-success me-2" style="font-size: 1.5rem;"></i>
                      <div>
                        <strong>認証完了</strong><br>
                        <small>電話番号と身分証明書の認証が完了し、すべての機能がご利用いただけます</small>
                      </div>
                    </div>
                  </div>
                  
                  <h5 class="mb-3 text-primary">
                    <i class="bi bi-unlock-fill me-2"></i>アンロックされた機能
                  </h5>
                  
                  <div class="row">
                    <div class="col-md-6">
                      <div class="feature-card p-3 mb-3 border rounded" style="background: #f8f9fa;">
                        <div class="d-flex align-items-start">
                          <div class="feature-icon me-3 text-primary">
                            <i class="bi bi-person-lines-fill" style="font-size: 1.5rem;"></i>
                          </div>
                          <div>
                            <h6 class="fw-bold mb-1">ガイド詳細の閲覧</h6>
                            <p class="small text-muted mb-0">すべてのガイドのプロフィール、経歴、料金詳細を確認できます</p>
                          </div>
                        </div>
                      </div>
                      
                      <div class="feature-card p-3 mb-3 border rounded" style="background: #f8f9fa;">
                        <div class="d-flex align-items-start">
                          <div class="feature-icon me-3 text-primary">
                            <i class="bi bi-calendar-plus" style="font-size: 1.5rem;"></i>
                          </div>
                          <div>
                            <h6 class="fw-bold mb-1">ガイド予約機能</h6>
                            <p class="small text-muted mb-0">希望の日時でガイドを予約し、特別な体験を楽しめます</p>
                          </div>
                        </div>
                      </div>
                      
                      <div class="feature-card p-3 mb-3 border rounded" style="background: #f8f9fa;">
                        <div class="d-flex align-items-start">
                          <div class="feature-icon me-3 text-primary">
                            <i class="bi bi-chat-dots" style="font-size: 1.5rem;"></i>
                          </div>
                          <div>
                            <h6 class="fw-bold mb-1">メッセージ機能</h6>
                            <p class="small text-muted mb-0">ガイドと直接やり取りして詳細な相談ができます</p>
                          </div>
                        </div>
                      </div>
                    </div>
                    
                    <div class="col-md-6">
                      <div class="feature-card p-3 mb-3 border rounded" style="background: #f8f9fa;">
                        <div class="d-flex align-items-start">
                          <div class="feature-icon me-3 text-primary">
                            <i class="bi bi-heart" style="font-size: 1.5rem;"></i>
                          </div>
                          <div>
                            <h6 class="fw-bold mb-1">お気に入り機能</h6>
                            <p class="small text-muted mb-0">気になるガイドを保存して後から簡単にアクセスできます</p>
                          </div>
                        </div>
                      </div>
                      
                      <div class="feature-card p-3 mb-3 border rounded" style="background: #f8f9fa;">
                        <div class="d-flex align-items-start">
                          <div class="feature-icon me-3 text-primary">
                            <i class="bi bi-star" style="font-size: 1.5rem;"></i>
                          </div>
                          <div>
                            <h6 class="fw-bold mb-1">レビュー投稿</h6>
                            <p class="small text-muted mb-0">体験後にレビューを投稿して他の観光客をサポート</p>
                          </div>
                        </div>
                      </div>
                      
                      <div class="feature-card p-3 mb-3 border rounded" style="background: #f8f9fa;">
                        <div class="d-flex align-items-start">
                          <div class="feature-icon me-3 text-primary">
                            <i class="bi bi-credit-card" style="font-size: 1.5rem;"></i>
                          </div>
                          <div>
                            <h6 class="fw-bold mb-1">安全な決済</h6>
                            <p class="small text-muted mb-0">セキュアな決済システムで安心してお支払いできます</p>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <div class="alert alert-info border-0 mt-4" style="background: linear-gradient(135deg, #d1ecf1, #bee5eb);">
                    <div class="d-flex">
                      <i class="bi bi-info-circle text-info me-2 flex-shrink-0"></i>
                      <div>
                        <strong>次のステップ</strong><br>
                        <small>今すぐお好みのガイドを見つけて、日本での素晴らしい体験を始めましょう！</small>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="modal-footer border-0 pt-0">
                  <div class="w-100 d-flex justify-content-center gap-3">
                    <button type="button" class="btn btn-success btn-lg px-4" onclick="exploreGuides()">
                      <i class="bi bi-search me-2"></i>ガイドを探す
                    </button>
                    <button type="button" class="btn btn-outline-secondary btn-lg" onclick="closeSuccessModal()">
                      後で見る
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        `;
        
        // 既存の成功モーダルを削除
        const existingModal = document.getElementById('touristSuccessModal');
        if (existingModal) {
          existingModal.remove();
        }
        
        // 新しいモーダルを追加
        document.body.insertAdjacentHTML('beforeend', successModalHTML);
        
        // 5秒後に自動でガイド探索を促すアニメーション
        setTimeout(() => {
          const exploreBtn = document.querySelector('#touristSuccessModal .btn-success');
          if (exploreBtn) {
            exploreBtn.classList.add('animate__animated', 'animate__pulse');
          }
        }, 5000);
      }
      
      /**
       * ガイド探索に移動
       */
      window.exploreGuides = function() {
        closeSuccessModal();
        // ページトップのガイドセクションにスクロール
        document.getElementById('guides').scrollIntoView({ behavior: 'smooth' });
        
        // 少し遅延してフィルターのヒントを表示
        setTimeout(() => {
          if (typeof window.showFilterHint === 'function') {
            window.showFilterHint();
          }
        }, 1000);
      }
      
      /**
       * 成功モーダルを閉じる
       */
      window.closeSuccessModal = function() {
        const modal = document.getElementById('touristSuccessModal');
        if (modal) {
          modal.style.display = 'none';
          modal.remove();
        }
      }
      
      // お問い合わせフォームの送信処理
      const contactForm = document.getElementById('contact-form');
      if (contactForm) {
        contactForm.addEventListener('submit', function(e) {
          e.preventDefault();
          alert('お問い合わせを受け付けました。担当者からの返信をお待ちください。');
          const modal = bootstrap.Modal.getInstance(document.getElementById('contactModal'));
          modal.hide();
        });
      }
      
      // もっと見るボタンの機能追加
      const loadMoreButton = document.getElementById('load-more-guides');
      if (loadMoreButton) {
        loadMoreButton.addEventListener('click', function() {
          // 非表示のガイドカードを表示する
          const hiddenGuides = document.querySelectorAll('.hidden-guide');
          hiddenGuides.forEach(guide => {
            guide.classList.remove('hidden-guide');
            // フェードインアニメーション
            guide.style.opacity = 0;
            guide.style.transition = 'opacity 0.5s ease';
            setTimeout(() => {
              guide.style.opacity = 1;
            }, 50);
          });
          
          // すべて表示したらボタンを非表示にする
          if (hiddenGuides.length > 0) {
            this.textContent = 'すべて表示しました';
            this.disabled = true;
            setTimeout(() => {
              this.style.display = 'none';
            }, 2000);
          }
        });
      }
      
      // プロフィール写真のプレビュー機能
      const guideProfilePhoto = document.getElementById('guide-profile-photo');
      const guideProfilePreview = document.getElementById('guide-profile-preview');
      const profilePhotoContainer = document.querySelector('.profile-photo-container');
      
      if (guideProfilePhoto && guideProfilePreview) {
        // ファイル選択時のプレビュー表示
        guideProfilePhoto.addEventListener('change', function(e) {
          if (this.files && this.files[0]) {
            const reader = new FileReader();
            
            reader.onload = function(e) {
              guideProfilePreview.src = e.target.result;
            }
            
            reader.readAsDataURL(this.files[0]);
          }
        });
        
        // プロフィール写真コンテナをクリックしたらファイル選択を開く
        if (profilePhotoContainer) {
          profilePhotoContainer.addEventListener('click', function() {
            guideProfilePhoto.click();
          });
        }
      }
      
      // 詳細を見るボタンのイベントハンドラ
      document.addEventListener('click', function(e) {
        // 詳細を見るボタンがクリックされた場合（複数の条件をチェック）
        const isDetailsButton = e.target.classList.contains('guide-details-link') ||
                               (e.target.classList.contains('btn-outline-primary') && 
                                (e.target.textContent.includes('詳細を見る') || e.target.textContent.includes('See Details'))) ||
                               e.target.hasAttribute('data-guide-id');
        
        if (isDetailsButton) {
          e.preventDefault();
          // ガイドIDを取得
          let guideId = e.target.getAttribute('data-guide-id');
          if (!guideId) {
            const guideCard = e.target.closest('.guide-card');
            if (guideCard) {
              guideId = guideCard.getAttribute('data-guide-id');
            }
          }
          
          if (!guideId) {
            alert('ガイドIDが見つかりません');
            return;
          }
          
          // 観光客としてログイン済みかチェック
          const touristData = localStorage.getItem('touristData');
          console.log('ガイド詳細クリック - 認証データ:', touristData);
          
          if (touristData) {
            try {
              const userData = JSON.parse(touristData);
              console.log('ユーザーデータ:', userData);
              if (userData && userData.type === 'tourist') {
                // 観光客としてログイン済みなら詳細ページへ移動
                console.log('認証済みユーザー - 詳細ページに遷移');
                window.location.href = `guide-details.html?id=${guideId}`;
                return;
              }
            } catch (e) {
              console.log('認証データ解析エラー:', e);
            }
          }
          
          // 未ログインまたは無効な認証データの場合 - メインページで登録促進モーダル表示
          console.log('未認証ユーザー - 登録促進モーダルを表示');
          localStorage.removeItem('touristData');
          sessionStorage.removeItem('currentUser');
          sessionStorage.setItem('pendingGuideId', guideId);
          showTouristLoginPrompt(guideId);
        }
      });
      
      // 観光客ログインを促すモーダル表示
      function showTouristLoginPrompt(guideId) {
        console.log('観光客登録促進モーダルを表示:', guideId);
        
        // カスタムモーダルを作成
        const modalHTML = `
          <div class="modal fade" id="loginPromptModal" tabindex="-1" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
              <div class="modal-content">
                <div class="modal-header border-0 text-center pb-0">
                  <div class="w-100">
                    <i class="bi bi-lock-fill text-warning" style="font-size: 3rem;"></i>
                    <h4 class="modal-title mt-3">ログインが必要です</h4>
                  </div>
                </div>
                <div class="modal-body text-center">
                  <p class="mb-4">選択されたガイドの詳細情報を見るには、観光客アカウントが必要です。</p>
                  
                  <div class="alert alert-info mb-4">
                    <i class="bi bi-info-circle me-2"></i>
                    <strong>初回ご利用の方へ：</strong><br>
                    まだアカウントをお持ちでない場合は、新規登録（無料）をお願いします。登録後、すぐにガイド詳細をご覧いただけます。
                  </div>
                  
                  <div class="bg-light rounded p-3 mb-4">
                    <h6 class="mb-2">ログイン後にできること</h6>
                    <div class="text-start small">
                      <div class="mb-1"><i class="bi bi-check-circle-fill text-success me-2"></i>ガイドの詳細プロフィール閲覧</div>
                      <div class="mb-1"><i class="bi bi-check-circle-fill text-success me-2"></i>ガイドとの直接予約・メッセージ</div>
                      <div class="mb-1"><i class="bi bi-check-circle-fill text-success me-2"></i>レビューの閲覧・投稿</div>
                      <div><i class="bi bi-check-circle-fill text-success me-2"></i>お気に入りガイドの保存</div>
                    </div>
                  </div>
                  
                  <div class="d-grid gap-2">
                    <button type="button" class="btn btn-success btn-lg" onclick="showTouristRegistration()">
                      <i class="bi bi-person-plus me-2"></i>新規登録（無料・1分で完了）
                    </button>
                    <button type="button" class="btn btn-outline-primary" onclick="showTouristLogin()">
                      <i class="bi bi-box-arrow-in-right me-2"></i>既存アカウントでログイン
                    </button>
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">
                      後で利用する
                    </button>
                  </div>
                  
                  <div class="mt-3 border-top pt-3">
                    <div class="d-flex align-items-center justify-content-center">
                      <i class="bi bi-shield-check text-success me-2"></i>
                      <small class="text-muted">安全で簡単な登録プロセス</small>
                    </div>
                    <div class="small text-muted mt-1">
                      新規登録は完全無料です。メール認証のみで、すぐにご利用いただけます。
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        `;
        
        // 既存のモーダルを削除
        const existingModal = document.getElementById('loginPromptModal');
        if (existingModal) {
          existingModal.remove();
        }
        
        // 新しいモーダルを追加
        document.body.insertAdjacentHTML('beforeend', modalHTML);
        
        // モーダルを表示
        const modal = new bootstrap.Modal(document.getElementById('loginPromptModal'));
        modal.show();
      }
      
      // 観光客ログインを表示
      window.showTouristLogin = function() {
        // ログイン促進モーダルを閉じる
        const promptModal = bootstrap.Modal.getInstance(document.getElementById('loginPromptModal'));
        if (promptModal) {
          promptModal.hide();
        }
        
        // 観光客ログインモーダルを表示
        setTimeout(() => {
          const loginModal = new bootstrap.Modal(document.getElementById('loginModal'));
          loginModal.show();
        }, 300);
      };
      
      // 観光客新規登録を表示
      window.showTouristRegistration = function() {
        // ログイン促進モーダルを閉じる
        const promptModal = bootstrap.Modal.getInstance(document.getElementById('loginPromptModal'));
        if (promptModal) {
          promptModal.hide();
        }
        
        // 観光客登録モーダルを表示
        setTimeout(() => {
          const registerModal = new bootstrap.Modal(document.getElementById('registerTouristModal'));
          registerModal.show();
        }, 300);
      };

      // ログイン必須ページから戻ってきた場合の処理
      const shouldOpenLogin = sessionStorage.getItem('openLoginAfterReturn');
      if (shouldOpenLogin === 'true') {
        sessionStorage.removeItem('openLoginAfterReturn');
        
        // 少し遅延してからログインモーダルを開く
        setTimeout(() => {
          const loginModal = new bootstrap.Modal(document.getElementById('loginModal'));
          loginModal.show();
        }, 500);
      }
    });
  </script>
  
  <!-- 包括的フィルターシステム -->
  <script src="comprehensive-filter.js"></script>
  
  <!-- フィルターチュートリアルシステム -->
  <script src="filter-tutorial.js"></script>
  
  <!-- 登録ボタン修正システム -->
  <script src="registration-fix.js"></script>
  
  <!-- 言語切り替え機能 - シンプル実装 -->
  <script src="minimal-language.js"></script>
  
  <!-- 専用ボタン翻訳機能 -->
  <script src="button-translator.js"></script>
  
  <!-- 統一認証システム -->
  <script src="unified-auth-system.js"></script>
  
  <!-- 認証テストヘルパー -->
  <script src="auth-test-helper.js"></script>
  
  <!-- セクション別の専用翻訳スクリプト -->
  <script src="benefits-translator.js"></script>
  <script src="dropdown-translator.js"></script>
  <script src="direct-benefit-card-translator.js"></script>
  <script src="benefit-html-inspector.js"></script>
  <script src="guide-cards-translator.js"></script>
  
  <!-- ガイド登録処理 -->
  <script src="guide_registration_handler.js"></script>
  
  <!-- ガイドログイン機能 -->
  <!-- テストガイドデータ生成・表示スクリプト -->
  <script src="generate-guide-data.js"></script>
  <script src="add-guide-data.js"></script>
  <script src="guide-login.js"></script>
  
  <!-- ガイドログインデバッグツール -->
  <script src="guide-login-debug.js"></script>
  
  <!-- 観光客ログイン機能 -->

  
  <!-- セッションデバッグ機能 -->
  <script src="session-debugger.js"></script>
  
  <!-- アクセス制御機能 -->

  
  <!-- デバイス別の最適化スクリプト - 各環境でのみ実行 -->
  <script src="smartphones.js"></script>
  <script src="desktop-fixes.js"></script>
  
  <!-- 共有言語ユーティリティ - 言語設定の保存と復元 -->
  <script src="shared-language-utils.js"></script>
  
  <!-- ナビゲーションボタン -->
  <script src="navigation-buttons.js"></script>
  
  <!-- ガイドタグ表示 -->
  <script src="guide-tags-display.js"></script>
  
  <!-- ガイドデータAPI (新機能) -->
  <script src="guide-data-storage-api.js"></script>
  
  <!-- ガイドデータ初期化 (新機能) -->
  <script src="initialize-guide-data.js"></script>
  
  <!-- ガイドカードデータ抽出器 (修正版) -->
  <script src="guide-card-extractor.js"></script>
  
  <!-- ガイド詳細データ管理 -->
  <script src="guide-details-data.js"></script>
  <script src="data-reset.js"></script>
  <script src="password-toggle.js"></script>
  
  <!-- モーダルの読み込み -->
  <div id="modals-container"></div>
  <script src="auto-fill-system.js"></script>
  <script src="load-70-guides.js"></script>
  <script src="filter-toggle.js"></script>
  
  <script>
    // モーダルHTMLを読み込む
    fetch('modals.html')
      .then(response => response.text())
      .then(html => {
        document.getElementById('modals-container').innerHTML = html;
        initializeRegistrationModals();
      })
      .catch(error => console.error('モーダル読み込みエラー:', error));

    // 登録モーダル初期化
    function initializeRegistrationModals() {
      // 新規登録ドロップダウンからの遷移
      const guideRegisterLinks = document.querySelectorAll('[data-bs-target="#registerGuideModal"]');
      const touristRegisterLinks = document.querySelectorAll('[data-bs-target="#registerTouristModal"]');
      
      guideRegisterLinks.forEach(link => {
        link.addEventListener('click', function(e) {
          e.preventDefault();
          const modal = new bootstrap.Modal(document.getElementById('registerGuideModal'));
          modal.show();
        });
      });
      
      touristRegisterLinks.forEach(link => {
        link.addEventListener('click', function(e) {
          e.preventDefault();
          const modal = new bootstrap.Modal(document.getElementById('registerTouristModal'));
          modal.show();
        });
      });

      // ガイド登録フォーム送信
      const submitGuideBtn = document.getElementById('submitGuideRegistration');
      if (submitGuideBtn) {
        submitGuideBtn.addEventListener('click', function() {
          handleGuideRegistration();
        });
      }

      // 観光客登録フォーム送信
      const submitTouristBtn = document.getElementById('submitTouristRegistration');
      if (submitTouristBtn) {
        submitTouristBtn.addEventListener('click', function() {
          handleTouristRegistration();
        });
      }
    }

    // ガイド登録処理
    function handleGuideRegistration() {
      const form = document.getElementById('guideRegistrationForm');
      const formData = new FormData(form);
      
      const name = formData.get('name');
      const email = formData.get('email');
      const sessionFee = formData.get('sessionFee');
      
      if (!name || !email) {
        showNotification('必須項目を入力してください', 'error');
        return;
      }
      
      if (sessionFee < 6000) {
        showNotification('セッション料金は最低¥6,000以上に設定してください', 'error');
        return;
      }

      const languages = Array.from(form.querySelectorAll('input[name="languages"]:checked')).map(cb => cb.value);
      if (languages.length === 0) {
        showNotification('対応言語を少なくとも1つ選択してください', 'error');
        return;
      }

      const verifyStatus = document.getElementById('verifyStatus');
      if (verifyStatus && verifyStatus.textContent !== '認証済み') {
        showNotification('電話番号認証を完了してください', 'error');
        return;
      }

      showNotification('ガイド登録を受け付けました。審査完了までお待ちください。', 'success');
      
      setTimeout(() => {
        const modal = bootstrap.Modal.getInstance(document.getElementById('registerGuideModal'));
        if (modal) {
          modal.hide();
        }
      }, 2000);
    }

    // 観光客登録処理
    function handleTouristRegistration() {
      const form = document.getElementById('touristRegistrationForm');
      const formData = new FormData(form);
      
      const name = formData.get('name');
      const email = formData.get('email');
      const password = formData.get('password');
      
      if (!name || !email || !password) {
        showNotification('必須項目を入力してください', 'error');
        return;
      }
      
      showNotification('観光客登録が完了しました。ガイドを探してみましょう！', 'success');
      
      setTimeout(() => {
        const modal = bootstrap.Modal.getInstance(document.getElementById('registerTouristModal'));
        if (modal) {
          modal.hide();
        }
      }, 2000);
    }

    // 通知表示関数
    function showNotification(message, type = 'info') {
      let alertContainer = document.getElementById('alert-container');
      if (!alertContainer) {
        alertContainer = document.createElement('div');
        alertContainer.id = 'alert-container';
        alertContainer.style.cssText = 'position: fixed; top: 20px; right: 20px; max-width: 400px; z-index: 9999;';
        document.body.appendChild(alertContainer);
      }
      
      const alertDiv = document.createElement('div');
      alertDiv.className = `alert alert-${type === 'success' ? 'success' : type === 'error' ? 'danger' : 'info'} alert-dismissible fade show`;
      alertDiv.innerHTML = `
        ${message}
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
      `;
      
      alertContainer.appendChild(alertDiv);
      
      setTimeout(() => {
        if (alertDiv.parentNode) {
          alertDiv.remove();
        }
      }, 5000);
    }
  </script>

  <!-- フィルターチュートリアルモーダル -->
  <div class="modal fade" id="filterTutorialModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header border-0 pb-0">
          <h5 class="modal-title">
            <i class="bi bi-funnel text-primary me-2"></i>フィルター機能の使い方
          </h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div class="tutorial-content">
            <!-- ステップ1 -->
            <div class="tutorial-step mb-4" data-step="1">
              <div class="d-flex align-items-start">
                <div class="step-number bg-primary text-white rounded-circle d-flex justify-content-center align-items-center me-3" style="width: 30px; height: 30px; font-size: 14px; font-weight: bold;">1</div>
                <div class="flex-grow-1">
                  <h6 class="fw-bold mb-2">フィルターを開く</h6>
                  <p class="text-muted mb-2">「ガイドを絞り込み」ボタンをクリックしてフィルター画面を表示します。</p>
                  <div class="tutorial-visual p-3 bg-light rounded">
                    <button class="btn btn-outline-primary" disabled>
                      <i class="bi bi-funnel"></i> ガイドを絞り込み
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- ステップ2 -->
            <div class="tutorial-step mb-4" data-step="2">
              <div class="d-flex align-items-start">
                <div class="step-number bg-primary text-white rounded-circle d-flex justify-content-center align-items-center me-3" style="width: 30px; height: 30px; font-size: 14px; font-weight: bold;">2</div>
                <div class="flex-grow-1">
                  <h6 class="fw-bold mb-2">条件を選択</h6>
                  <p class="text-muted mb-2">地域、言語、料金、キーワードなど、お好みの条件を選択できます。</p>
                  <div class="tutorial-visual p-3 bg-light rounded">
                    <div class="row g-2">
                      <div class="col-6">
                        <select class="form-select form-select-sm" disabled>
                          <option>地域を選択</option>
                        </select>
                      </div>
                      <div class="col-6">
                        <select class="form-select form-select-sm" disabled>
                          <option>言語を選択</option>
                        </select>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- ステップ3 -->
            <div class="tutorial-step mb-4" data-step="3">
              <div class="d-flex align-items-start">
                <div class="step-number bg-primary text-white rounded-circle d-flex justify-content-center align-items-center me-3" style="width: 30px; height: 30px; font-size: 14px; font-weight: bold;">3</div>
                <div class="flex-grow-1">
                  <h6 class="fw-bold mb-2">フィルターを適用</h6>
                  <p class="text-muted mb-2">「フィルターを適用」ボタンで検索結果が更新されます。</p>
                  <div class="tutorial-visual p-3 bg-light rounded">
                    <button class="btn btn-primary btn-sm" disabled>
                      <i class="bi bi-search"></i> フィルターを適用
                    </button>
                    <button class="btn btn-outline-secondary btn-sm ms-2" disabled>
                      <i class="bi bi-arrow-clockwise"></i> リセット
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- ステップ4 -->
            <div class="tutorial-step mb-4" data-step="4">
              <div class="d-flex align-items-start">
                <div class="step-number bg-secondary text-white rounded-circle d-flex justify-content-center align-items-center me-3" style="width: 30px; height: 30px; font-size: 14px; font-weight: bold;">4</div>
                <div class="flex-grow-1">
                  <h6 class="fw-bold mb-2">もっと見るボタンについて</h6>
                  <p class="text-muted mb-2">フィルターをリセットした後は、最初の3名のガイドのみ表示されます。</p>
                  <div class="tutorial-visual p-3 bg-light rounded">
                    <button class="btn btn-primary btn-sm" disabled>もっと見る</button>
                    <div class="small text-muted mt-2">
                      ↑ このボタンで残りのガイドを表示できます
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- ヒント -->
            <div class="alert alert-info border-0" style="background: linear-gradient(135deg, #e3f2fd, #f0f9ff);">
              <div class="d-flex">
                <i class="bi bi-lightbulb text-info me-2 flex-shrink-0" style="font-size: 1.2em;"></i>
                <div>
                  <h6 class="fw-bold mb-1 text-info">便利なヒント</h6>
                  <ul class="mb-0 ps-3">
                    <li class="text-muted">複数の条件を組み合わせて絞り込みができます</li>
                    <li class="text-muted">リセットボタンでいつでも初期状態に戻せます</li>
                    <li class="text-muted">キーワード検索では趣味や得意分野で探せます</li>
                    <li class="text-muted"><strong>リセット後は「もっと見る」ボタンで全ガイドを表示</strong></li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer border-0 pt-0">
          <button type="button" class="btn btn-success" id="try-filter-btn">
            <i class="bi bi-play-circle me-1"></i>実際に試してみる
          </button>
          <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">閉じる</button>
        </div>
      </div>
    </div>
  </div>

</body>
</html>